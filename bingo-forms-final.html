<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RLC Bingo Forms - Final</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            line-height: 1.3;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: #2c5aa0;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .qr-section {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }

        .qr-code {
            width: 100px;
            height: 100px;
            background: white;
            margin: 10px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            font-size: 8px;
            text-align: center;
            color: #333;
        }

        .tabs {
            display: flex;
            background: #e9ecef;
            border-bottom: 1px solid #ddd;
            flex-wrap: wrap;
        }

        .tab-button {
            flex: 1;
            min-width: 140px;
            padding: 12px 15px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 11px;
            font-weight: bold;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            text-align: center;
        }

        .tab-button:hover {
            background: #dee2e6;
        }

        .tab-button.active {
            background: white;
            border-bottom-color: #2c5aa0;
            color: #2c5aa0;
        }

        .tab-content {
            display: none;
            padding: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .form-section {
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
            page-break-inside: avoid;
        }

        .section-header {
            background: #f8f9fa;
            padding: 10px;
            border-bottom: 1px solid #ddd;
            font-weight: bold;
            font-size: 13px;
        }

        .section-content {
            padding: 15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
            font-size: 11px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 5px;
            text-align: left;
            vertical-align: middle;
        }

        th {
            background: #f8f9fa;
            font-weight: bold;
            font-size: 10px;
        }

        input[type="number"], input[type="text"], input[type="date"], select {
            width: 100%;
            padding: 4px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 11px;
        }

        input[type="radio"] {
            margin-right: 5px;
        }

        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .btn {
            display: inline-block;
            padding: 8px 12px;
            margin: 2px;
            background: #2c5aa0;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
            text-decoration: none;
        }

        .btn:hover {
            background: #1e3a8a;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .occasion-info-box {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .calculating-only {
            display: block;
        }

        /* Print Styles */
        @media print {
            @page {
                margin: 0.3in;
                size: letter;
            }

            body {
                background: white;
                padding: 0;
                margin: 0;
                font-size: 7px;
                line-height: 1.0;
            }

            .container {
                box-shadow: none;
                border-radius: 0;
                margin: 0;
                padding: 0;
            }

            .header, .tabs, .controls, .qr-section, .calculating-only {
                display: none !important;
            }

            .tab-content {
                display: block !important;
                padding: 5px;
                margin: 0;
            }

            .tab-content:not(.print-active) {
                display: none !important;
            }

            .form-section {
                margin-bottom: 8px;
                page-break-inside: avoid;
                border: 1px solid #000;
            }

            .section-header {
                padding: 3px 5px;
                font-size: 8px;
                font-weight: bold;
                border-bottom: 1px solid #000;
                background: #f0f0f0;
            }

            .section-content {
                padding: 5px;
            }

            table {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 5px;
                font-size: 6px;
            }

            th, td {
                border: 1px solid #000;
                padding: 1px 2px;
                text-align: left;
                font-size: 6px;
                line-height: 1.0;
            }

            th {
                background: #f0f0f0;
                font-weight: bold;
                font-size: 7px;
            }

            input {
                border: none !important;
                background: white !important;
                padding: 0;
                margin: 0;
                font-size: 6px;
                min-height: 8px;
                width: 100%;
            }

            /* Hide all values and placeholders for blank forms */
            .blank-form-print input {
                color: transparent !important;
                background: white !important;
            }

            .blank-form-print select {
                color: transparent !important;
            }

            .two-column {
                display: block;
            }

            .occasion-info-box {
                padding: 5px;
                margin-bottom: 5px;
                border: 1px solid #000;
                font-size: 6px;
            }

            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Rolla Lions Club - Bingo Forms</h1>
            <p>Complete System - All Issues Fixed</p>
            <div class="qr-section">
                <div class="qr-code">
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=90x90&data=https://bill-wiggins.github.io/rlc-bingo-manager/mobile" alt="QR Code" style="width: 90px; height: 90px;">
                </div>
                <p><small>Scan for mobile entry</small></p>
            </div>
        </header>

        <div class="controls">
            <button class="btn" onclick="printBlankPacket()">Print Blank Packet</button>
            <input type="number" id="packetQty" value="1" min="1" max="10" style="width: 50px; margin: 0 5px;">
            <br>
            <button class="btn" onclick="printPlayerSheets()">Print Player Sheets</button>
            <input type="number" id="playerQty" value="5" min="1" max="20" style="width: 50px; margin: 0 5px;">
            <br>
            <button class="btn btn-secondary" onclick="printCurrentTab()">Print Current Tab</button>
            <br>
            <button class="btn btn-secondary" onclick="saveData()">Save Occasion</button>
            <button class="btn btn-secondary" onclick="loadData()">Load Occasion</button>
            <br>
            <button class="btn btn-secondary" onclick="generateSMS()">Generate SMS</button>
        </div>

        <nav class="tabs">
            <button class="tab-button active" onclick="showTab('setup')">Occasion Setup</button>
            <button class="tab-button" onclick="showTab('counts')">Manual Counts</button>
            <button class="tab-button" onclick="showTab('door-sales')">Door Sales Entry</button>
            <button class="tab-button" onclick="showTab('games')">Occasion Games</button>
            <button class="tab-button" onclick="showTab('pulltabs')">Pull-Tabs</button>
            <button class="tab-button" onclick="showTab('money')">Money Summary</button>
            <button class="tab-button" onclick="showTab('metrics')">Metrics & Summary</button>
        </nav>

        <!-- Occasion Setup Tab -->
        <div id="setup" class="tab-content active">
            <div class="form-section">
                <div class="section-header">Occasion Setup & Basic Information</div>
                <div class="section-content">
                    <div class="occasion-info-box">
                        <h3>Current Occasion Info</h3>
                        <div id="occasion-display">
                            <p><strong>Date:</strong> <span id="display-date">Not Set</span></p>
                            <p><strong>Occasion:</strong> <span id="display-occasion">Not Set</span></p>
                            <p><strong>Progressive Jackpot:</strong> $<span id="display-jackpot">1000.00</span></p>
                        </div>
                    </div>

                    <div class="two-column">
                        <div>
                            <h4>Occasion Information</h4>
                            <table>
                                <tr>
                                    <td><strong>Occasion Date:</strong></td>
                                    <td><input type="date" id="occasion_date" onchange="autoSelectOccasion()"></td>
                                </tr>
                                <tr>
                                    <td><strong>Occasion Type:</strong></td>
                                    <td>
                                        <select id="occasion_type" onchange="updateOccasionDisplay()">
                                            <option value="">Auto-Select from Date</option>
                                            <option value="5-1">5-1 (1st & 5th Monday)</option>
                                            <option value="6-2">6-2 (2nd Monday)</option>
                                            <option value="7-3">7-3 (3rd Monday)</option>
                                            <option value="8-4">8-4 (4th Monday)</option>
                                        </select>
                                    </td>
                                </tr>
                            </table>

                            <h4 style="margin-top: 15px;">Workers</h4>
                            <table>
                                <tr>
                                    <td><strong>Bingo Closet Worker:</strong></td>
                                    <td><input type="text" id="bingo_worker" placeholder="Enter name"></td>
                                </tr>
                                <tr>
                                    <td><strong>Pull-Tabs Worker:</strong></td>
                                    <td><input type="text" id="pulltabs_worker" placeholder="Enter name"></td>
                                </tr>
                            </table>
                        </div>

                        <div>
                            <h4>Progressive Game Setup</h4>
                            <table>
                                <tr>
                                    <td><strong>Progressive Jackpot:</strong></td>
                                    <td><input type="number" step="0.01" id="progressive_jackpot_setup" value="1000.00" onchange="updateOccasionDisplay()"></td>
                                </tr>
                                <tr>
                                    <td><strong>Balls to Win Jackpot:</strong></td>
                                    <td><input type="number" id="progressive_balls_setup" value="17" min="1" max="75" onchange="updateOccasionDisplay()"></td>
                                </tr>
                                <tr>
                                    <td><strong>Consolation Prize:</strong></td>
                                    <td><input type="number" step="0.01" id="progressive_consolation_setup" value="200.00" onchange="updateOccasionDisplay()"></td>
                                </tr>
                            </table>

                            <h4 style="margin-top: 15px;">Occasion Statistics</h4>
                            <table>
                                <tr>
                                    <td><strong>Total Players:</strong></td>
                                    <td><input type="number" id="total_players" placeholder="0"></td>
                                </tr>
                                <tr>
                                    <td><strong>Birthday BOGOs:</strong></td>
                                    <td><input type="number" id="birthday_bogos" placeholder="0" onchange="updateBirthdayCalculations()"></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Manual Counts Tab -->
        <div id="counts" class="tab-content">
            <div class="form-section">
                <div class="section-header">Paper Bingo Sales - Beginning & Ending Counts</div>
                <div class="section-content">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 25%;">Product</th>
                                <th style="width: 15%;">Start Count</th>
                                <th style="width: 15%;">Free Given</th>
                                <th style="width: 15%;">End Count</th>
                                <th style="width: 15%;">Sold</th>
                                <th style="width: 15%;">Unit Price</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Early Bird Doubles</td>
                                <td><input type="number" id="eb_start" placeholder="0" onchange="calculateCounts()"></td>
                                <td><input type="number" id="eb_free" readonly></td>
                                <td><input type="number" id="eb_end" placeholder="0" onchange="calculateCounts()"></td>
                                <td><input type="number" id="eb_sold" readonly></td>
                                <td>$5.00</td>
                            </tr>
                            <tr>
                                <td>6 Face Packs</td>
                                <td><input type="number" id="six_start" placeholder="0" onchange="calculateCounts()"></td>
                                <td><input type="number" id="six_free" readonly></td>
                                <td><input type="number" id="six_end" placeholder="0" onchange="calculateCounts()"></td>
                                <td><input type="number" id="six_sold" readonly></td>
                                <td>$10.00</td>
                            </tr>
                            <tr>
                                <td>9 Face Solid</td>
                                <td><input type="number" id="solid_start" placeholder="0" onchange="calculateCounts()"></td>
                                <td>0</td>
                                <td><input type="number" id="solid_end" placeholder="0" onchange="calculateCounts()"></td>
                                <td><input type="number" id="solid_sold" readonly></td>
                                <td>$15.00</td>
                            </tr>
                            <tr>
                                <td>9 Face Stripe</td>
                                <td><input type="number" id="stripe_start" placeholder="0" onchange="calculateCounts()"></td>
                                <td>0</td>
                                <td><input type="number" id="stripe_end" placeholder="0" onchange="calculateCounts()"></td>
                                <td><input type="number" id="stripe_sold" readonly></td>
                                <td>$10.00</td>
                            </tr>
                            <tr>
                                <td>Progressive $1 Sheets</td>
                                <td><input type="number" id="prog1_start" placeholder="0" onchange="calculateCounts()"></td>
                                <td>0</td>
                                <td><input type="number" id="prog1_end" placeholder="0" onchange="calculateCounts()"></td>
                                <td><input type="number" id="prog1_sold" readonly></td>
                                <td>$1.00</td>
                            </tr>
                            <tr>
                                <td>Progressive $5 Sheets</td>
                                <td><input type="number" id="prog5_start" placeholder="0" onchange="calculateCounts()"></td>
                                <td>0</td>
                                <td><input type="number" id="prog5_end" placeholder="0" onchange="calculateCounts()"></td>
                                <td><input type="number" id="prog5_sold" readonly></td>
                                <td>$5.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Door Sales Entry Tab -->
        <div id="door-sales" class="tab-content">
            <div class="form-section">
                <div class="section-header">POS Door Sales Summary - Direct Entry</div>
                <div class="section-content">
                    <p><small><em>Enter data exactly as shown on POS Door Sales Summary report</em></small></p>

                    <h4>Electronic Bingo</h4>
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 50%;">Item</th>
                                <th style="width: 20%;">Net Sold</th>
                                <th style="width: 15%;">Price</th>
                                <th style="width: 15%;">Net Sales</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Small Machines (27reg18pro $40)</td>
                                <td><input type="number" id="pos_small" placeholder="0" onchange="calculateDoorSales()"></td>
                                <td>$40.00</td>
                                <td><input type="number" step="0.01" id="pos_small_total" readonly></td>
                            </tr>
                            <tr>
                                <td>Large Machines (45reg36pro $65)</td>
                                <td><input type="number" id="pos_large" placeholder="0" onchange="calculateDoorSales()"></td>
                                <td>$65.00</td>
                                <td><input type="number" step="0.01" id="pos_large_total" readonly></td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Paper Products (Alphabetical Order)</h4>
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 50%;">Item</th>
                                <th style="width: 20%;">Net Sold</th>
                                <th style="width: 15%;">Price</th>
                                <th style="width: 15%;">Net Sales</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>6 Face Packs</td>
                                <td><input type="number" id="pos_six" placeholder="0" onchange="calculateDoorSales()"></td>
                                <td>$10.00</td>
                                <td><input type="number" step="0.01" id="pos_six_total" readonly></td>
                            </tr>
                            <tr>
                                <td>9 Face Solid</td>
                                <td><input type="number" id="pos_solid" placeholder="0" onchange="calculateDoorSales()"></td>
                                <td>$15.00</td>
                                <td><input type="number" step="0.01" id="pos_solid_total" readonly></td>
                            </tr>
                            <tr>
                                <td>9 Face Stripe</td>
                                <td><input type="number" id="pos_stripe" placeholder="0" onchange="calculateDoorSales()"></td>
                                <td>$10.00</td>
                                <td><input type="number" step="0.01" id="pos_stripe_total" readonly></td>
                            </tr>
                            <tr>
                                <td>Birthday BOGO Packs</td>
                                <td><input type="number" id="pos_birthday" readonly></td>
                                <td>$0.00</td>
                                <td><input type="number" step="0.01" id="pos_birthday_total" readonly></td>
                            </tr>
                            <tr>
                                <td>Coverall Extra Sheets</td>
                                <td><input type="number" id="pos_coverall_extra" placeholder="0" onchange="calculateDoorSales()"></td>
                                <td>$1.00</td>
                                <td><input type="number" step="0.01" id="pos_coverall_extra_total" readonly></td>
                            </tr>
                            <tr>
                                <td>Early Bird Doubles</td>
                                <td><input type="number" id="pos_eb" placeholder="0" onchange="calculateDoorSales()"></td>
                                <td>$5.00</td>
                                <td><input type="number" step="0.01" id="pos_eb_total" readonly></td>
                            </tr>
                            <tr>
                                <td>Letter X Extra Sheets</td>
                                <td><input type="number" id="pos_letterx_extra" placeholder="0" onchange="calculateDoorSales()"></td>
                                <td>$1.00</td>
                                <td><input type="number" step="0.01" id="pos_letterx_extra_total" readonly></td>
                            </tr>
                            <tr>
                                <td>Number 7 Extra Sheets</td>
                                <td><input type="number" id="pos_number7_extra" placeholder="0" onchange="calculateDoorSales()"></td>
                                <td>$1.00</td>
                                <td><input type="number" step="0.01" id="pos_number7_extra_total" readonly></td>
                            </tr>
                            <tr>
                                <td>Progressive 18 Face</td>
                                <td><input type="number" id="pos_prog18" placeholder="0" onchange="calculateDoorSales()"></td>
                                <td>$5.00</td>
                                <td><input type="number" step="0.01" id="pos_prog18_total" readonly></td>
                            </tr>
                            <tr>
                                <td>Progressive 3 Face</td>
                                <td><input type="number" id="pos_prog3" placeholder="0" onchange="calculateDoorSales()"></td>
                                <td>$1.00</td>
                                <td><input type="number" step="0.01" id="pos_prog3_total" readonly></td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Miscellaneous Sales</h4>
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 50%;">Item</th>
                                <th style="width: 20%;">Net Sold</th>
                                <th style="width: 15%;">Price</th>
                                <th style="width: 15%;">Net Sales</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Daubers</td>
                                <td><input type="number" id="pos_daubers" placeholder="0" onchange="calculateDoorSales()"></td>
                                <td>$2.00</td>
                                <td><input type="number" step="0.01" id="pos_daubers_total" readonly></td>
                            </tr>
                        </tbody>
                    </table>

                    <table style="margin-top: 15px; width: 300px;">
                        <tr>
                            <td><strong>TOTAL BINGO SALES:</strong></td>
                            <td><input type="number" step="0.01" id="total_bingo_sales" readonly></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <!-- Occasion Games Tab -->
        <div id="games" class="tab-content">
            <div class="form-section">
                <div class="section-header">Occasion Games Sheet - Prize Allocation</div>
                <div class="section-content">
                    <h4>Early Bird Games (1-3)</h4>
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 10%;">Game #</th>
                                <th style="width: 40%;">Game Name</th>
                                <th style="width: 20%;">Total Prize</th>
                                <th style="width: 15%;">Winners</th>
                                <th style="width: 15%;">Per Winner</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td><input type="text" id="game1_name" value="Hard Way Bingo No Free Space"></td>
                                <td><input type="number" step="0.01" id="game1_prize" value="100.00" onchange="calculateGamePrize(1)"></td>
                                <td>
                                    <button class="btn btn-secondary no-print" onclick="changeWinners(1, -1)">-</button>
                                    <input type="number" id="game1_winners" value="1" min="1" style="width: 40px; text-align: center;" onchange="calculateGamePrize(1)">
                                    <button class="btn btn-secondary no-print" onclick="changeWinners(1, 1)">+</button>
                                </td>
                                <td><input type="number" step="0.01" id="game1_per_winner" readonly></td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td><input type="text" id="game2_name" value="Diagonal & Outside Corners"></td>
                                <td><input type="number" step="0.01" id="game2_prize" value="100.00" onchange="calculateGamePrize(2)"></td>
                                <td>
                                    <button class="btn btn-secondary no-print" onclick="changeWinners(2, -1)">-</button>
                                    <input type="number" id="game2_winners" value="1" min="1" style="width: 40px; text-align: center;" onchange="calculateGamePrize(2)">
                                    <button class="btn btn-secondary no-print" onclick="changeWinners(2, 1)">+</button>
                                </td>
                                <td><input type="number" step="0.01" id="game2_per_winner" readonly></td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td><input type="text" id="game3_name" value="Small Picture Frame"></td>
                                <td><input type="number" step="0.01" id="game3_prize" value="100.00" onchange="calculateGamePrize(3)"></td>
                                <td>
                                    <button class="btn btn-secondary no-print" onclick="changeWinners(3, -1)">-</button>
                                    <input type="number" id="game3_winners" value="1" min="1" style="width: 40px; text-align: center;" onchange="calculateGamePrize(3)">
                                    <button class="btn btn-secondary no-print" onclick="changeWinners(3, 1)">+</button>
                                </td>
                                <td><input type="number" step="0.01" id="game3_per_winner" readonly></td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Regular Bingo Games</h4>
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 10%;">Game #</th>
                                <th style="width: 40%;">Game Name</th>
                                <th style="width: 20%;">Total Prize</th>
                                <th style="width: 15%;">Winners</th>
                                <th style="width: 15%;">Per Winner</th>
                            </tr>
                        </thead>
                        <tbody id="regular_games_body">
                            <!-- Regular games will be populated by JavaScript -->
                        </tbody>
                    </table>

                    <h4>Special Games</h4>
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 10%;">Game #</th>
                                <th style="width: 30%;">Game Name</th>
                                <th style="width: 25%;">Prize Setup</th>
                                <th style="width: 15%;">Winners</th>
                                <th style="width: 15%;">Per Winner</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>9</td>
                                <td><input type="text" id="game9_name" value="Special Event Pull-tab" readonly></td>
                                <td><input type="text" id="game9_prize_display" value="From Pull-tabs" readonly></td>
                                <td>
                                    <button class="btn btn-secondary no-print" onclick="changeWinners(9, -1)">-</button>
                                    <input type="number" id="game9_winners" value="1" min="1" style="width: 40px; text-align: center;" onchange="calculateGamePrize(9)">
                                    <button class="btn btn-secondary no-print" onclick="changeWinners(9, 1)">+</button>
                                </td>
                                <td><input type="number" step="0.01" id="game9_per_winner" readonly></td>
                            </tr>
                            <tr>
                                <td>13</td>
                                <td><input type="text" id="game13_name" value="Progressive Diamond"></td>
                                <td>
                                    <div style="font-size: 9px;">
                                        Actual Balls: <input type="number" id="progressive_balls_actual" placeholder="17" min="1" max="75" style="width: 40px;" onchange="calculateProgressivePrize()">
                                        <br>Prize: $<span id="progressive_prize_display">1000.00</span>
                                    </div>
                                </td>
                                <td>
                                    <button class="btn btn-secondary no-print" onclick="changeWinners(13, -1)">-</button>
                                    <input type="number" id="game13_winners" value="1" min="1" style="width: 40px; text-align: center;" onchange="calculateProgressivePrize()">
                                    <button class="btn btn-secondary no-print" onclick="changeWinners(13, 1)">+</button>
                                </td>
                                <td><input type="number" step="0.01" id="game13_per_winner" readonly></td>
                            </tr>
                        </tbody>
                    </table>

                    <table style="margin-top: 15px; width: 400px;">
                        <tr>
                            <td><strong>TOTAL BINGO PRIZES PAID:</strong></td>
                            <td><input type="number" step="0.01" id="total_bingo_prizes" readonly></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <!-- Pull-Tabs Tab -->
        <div id="pulltabs" class="tab-content">
            <div class="form-section">
                <div class="section-header">Pull-Tab Nightly Summary</div>
                <div class="section-content">
                    <div class="calculating-only" style="margin-bottom: 15px;">
                        <button class="btn btn-secondary" onclick="addPulltabGame()">Add Game</button>
                        <button class="btn btn-secondary" onclick="removePulltabGame()">Remove Last</button>
                    </div>

                    <h4>Pull-Tab Games</h4>
                    <table id="pulltab_games_table">
                        <thead>
                            <tr>
                                <th style="width: 25%;">Game Name</th>
                                <th style="width: 15%;">Serial #</th>
                                <th style="width: 10%;">Price</th>
                                <th style="width: 15%;">Tickets Sold</th>
                                <th style="width: 15%;">Prizes Paid</th>
                                <th style="width: 10%;">Sales</th>
                                <th style="width: 10%;">Profit</th>
                            </tr>
                        </thead>
                        <tbody id="pulltab_games_body">
                            <!-- Games will be populated by JavaScript -->
                        </tbody>
                    </table>

                    <h4>Pull-Tab Summary</h4>
                    <div class="two-column">
                        <table>
                            <tr>
                                <td><strong>Total Sales:</strong></td>
                                <td><input type="number" step="0.01" id="pulltab_total_sales" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Total Prizes Paid:</strong></td>
                                <td><input type="number" step="0.01" id="pulltab_total_prizes" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Gross Profit:</strong></td>
                                <td><input type="number" step="0.01" id="pulltab_gross_profit" readonly></td>
                            </tr>
                        </table>
                        <table>
                            <tr>
                                <td><strong>Cash Turned In:</strong></td>
                                <td><input type="number" step="0.01" id="pulltab_cash_turned_in" placeholder="0.00" onchange="calculatePulltabMetrics()"></td>
                            </tr>
                            <tr>
                                <td><strong>Less Startup Cash:</strong></td>
                                <td><input type="number" step="0.01" id="pulltab_startup" value="550.00" onchange="calculatePulltabMetrics()"></td>
                            </tr>
                            <tr>
                                <td><strong>Net Profit:</strong></td>
                                <td><input type="number" step="0.01" id="pulltab_net_profit" readonly></td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Money Summary Tab -->
        <div id="money" class="tab-content">
            <div class="form-section">
                <div class="section-header">Money Summary Sheet - Deposit Preparation</div>
                <div class="section-content">
                    <div class="occasion-info-box">
                        <strong>Instructions:</strong> Remember to write a check for next week's startup cash and include in the bank bag along with the cash deposit and deposit slip.<br>
                        <strong>Pay to:</strong> "T&C Bank for Bingo Cash" | <strong>Amount:</strong> $1,000.00 | <strong>Memo:</strong> "For Bingo [enter date of next session m/d/yy]"
                    </div>

                    <table>
                        <thead>
                            <tr>
                                <th style="width: 25%;">Denomination</th>
                                <th style="width: 25%;">Bingo ($)</th>
                                <th style="width: 25%;">Pull-Tabs ($)</th>
                                <th style="width: 25%;">Total ($)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>$100's</td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="bingo_100s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="pulltab_100s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" id="total_100s" readonly></td>
                            </tr>
                            <tr>
                                <td>$50's</td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="bingo_50s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="pulltab_50s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" id="total_50s" readonly></td>
                            </tr>
                            <tr>
                                <td>$20's</td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="bingo_20s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="pulltab_20s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" id="total_20s" readonly></td>
                            </tr>
                            <tr>
                                <td>$10's</td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="bingo_10s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="pulltab_10s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" id="total_10s" readonly></td>
                            </tr>
                            <tr>
                                <td>$5's</td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="bingo_5s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="pulltab_5s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" id="total_5s" readonly></td>
                            </tr>
                            <tr>
                                <td>$2's</td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="bingo_2s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="pulltab_2s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" id="total_2s" readonly></td>
                            </tr>
                            <tr>
                                <td>$1's</td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="bingo_1s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="pulltab_1s" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" id="total_1s" readonly></td>
                            </tr>
                            <tr>
                                <td>Quarters</td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="bingo_quarters" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="pulltab_quarters" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" id="total_quarters" readonly></td>
                            </tr>
                            <tr>
                                <td>Dimes</td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="bingo_dimes" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="pulltab_dimes" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" id="total_dimes" readonly></td>
                            </tr>
                            <tr>
                                <td>Nickels</td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="bingo_nickels" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="pulltab_nickels" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" id="total_nickels" readonly></td>
                            </tr>
                            <tr>
                                <td>Pennies</td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="bingo_pennies" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="pulltab_pennies" onchange="calculateMoney()"></td>
                                <td><input type="number" step="0.01" id="total_pennies" readonly></td>
                            </tr>
                            <tr style="background: #f0f0f0; font-weight: bold;">
                                <td><strong>SUBTOTALS</strong></td>
                                <td><input type="number" step="0.01" id="bingo_subtotal" readonly></td>
                                <td><input type="number" step="0.01" id="pulltab_subtotal" readonly></td>
                                <td><input type="number" step="0.01" id="total_subtotal" readonly></td>
                            </tr>
                            <tr>
                                <td>Checks (Bingo Only)</td>
                                <td><input type="number" step="0.01" placeholder="0.00" id="bingo_checks" onchange="calculateMoney()"></td>
                                <td>$0.00</td>
                                <td><input type="number" step="0.01" id="total_checks" readonly></td>
                            </tr>
                            <tr style="background: #e0e0e0; font-weight: bold;">
                                <td><strong>TOTAL DEPOSIT</strong></td>
                                <td><input type="number" step="0.01" id="bingo_total" readonly></td>
                                <td><input type="number" step="0.01" id="pulltab_total" readonly></td>
                                <td><input type="number" step="0.01" id="grand_total" readonly></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Metrics & Summary Tab -->
        <div id="metrics" class="tab-content">
            <div class="form-section">
                <div class="section-header">Occasion Metrics & Reconciliation Summary</div>
                <div class="section-content">
                    <h4>Financial Summary</h4>
                    <div class="two-column">
                        <table>
                            <tr>
                                <td><strong>Total Bingo Sales:</strong></td>
                                <td><input type="number" step="0.01" id="metrics_bingo_sales" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Total Pull-tab Sales:</strong></td>
                                <td><input type="number" step="0.01" id="metrics_pulltab_sales" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Total Gross Sales:</strong></td>
                                <td><input type="number" step="0.01" id="metrics_gross_sales" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Total Bingo Prizes:</strong></td>
                                <td><input type="number" step="0.01" id="metrics_bingo_prizes" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Total Pull-tab Prizes:</strong></td>
                                <td><input type="number" step="0.01" id="metrics_pulltab_prizes" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Total Prizes Paid:</strong></td>
                                <td><input type="number" step="0.01" id="metrics_total_prizes" readonly></td>
                            </tr>
                        </table>
                        <table>
                            <tr>
                                <td><strong>Bingo Net Profit:</strong></td>
                                <td><input type="number" step="0.01" id="metrics_bingo_profit" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Pull-tab Net Profit:</strong></td>
                                <td><input type="number" step="0.01" id="metrics_pulltab_profit" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Total Net Profit:</strong></td>
                                <td><input type="number" step="0.01" id="metrics_total_profit" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Total Cash Deposit:</strong></td>
                                <td><input type="number" step="0.01" id="metrics_deposit" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Profit Per Player:</strong></td>
                                <td><input type="number" step="0.01" id="metrics_profit_per_player" readonly></td>
                            </tr>
                        </table>
                    </div>

                    <h4>Occasion Details</h4>
                    <div class="two-column">
                        <table>
                            <tr>
                                <td><strong>Occasion Date:</strong></td>
                                <td><input type="text" id="metrics_date" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Occasion Type:</strong></td>
                                <td><input type="text" id="metrics_occasion" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Total Players:</strong></td>
                                <td><input type="text" id="metrics_players" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Birthday BOGOs:</strong></td>
                                <td><input type="text" id="metrics_birthdays" readonly></td>
                            </tr>
                        </table>
                        <table>
                            <tr>
                                <td><strong>Bingo Worker:</strong></td>
                                <td><input type="text" id="metrics_bingo_worker" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Pull-tabs Worker:</strong></td>
                                <td><input type="text" id="metrics_pulltabs_worker" readonly></td>
                            </tr>
                            <tr>
                                <td><strong>Progressive Prize:</strong></td>
                                <td><input type="text" id="metrics_progressive" readonly></td>
                            </tr>
                        </table>
                    </div>

                    <div style="margin-top: 20px; text-align: center;">
                        <button class="btn" onclick="generateFinalReport()" style="font-size: 14px; padding: 10px 20px;">Generate Final Report & SMS</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Complete Game library data from CSV (150+ games)
        const gameLibrary = [
            {name: "Beat the Clock $599", totalTickets: 960, idealProfit: 361, pricePerTicket: 1.00},
            {name: "Black Jack $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Black Jack $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Black Jack $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Black Jack $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Black Jack $599", totalTickets: 840, idealProfit: 241, pricePerTicket: 1.00},
            {name: "Black Jack $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Bubble Gum $100", totalTickets: 150, idealProfit: 50, pricePerTicket: 1.00},
            {name: "Bubble Gum $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Bubble Gum $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Bubble Gum $325", totalTickets: 500, idealProfit: 175, pricePerTicket: 1.00},
            {name: "Bubble Gum $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Bubble Gum $599", totalTickets: 840, idealProfit: 241, pricePerTicket: 1.00},
            {name: "Bubble Gum $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Chase Your Dreams $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Chocolate $100", totalTickets: 150, idealProfit: 50, pricePerTicket: 1.00},
            {name: "Chocolate $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Chocolate $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Chocolate $325", totalTickets: 500, idealProfit: 175, pricePerTicket: 1.00},
            {name: "Chocolate $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Chocolate $599", totalTickets: 840, idealProfit: 241, pricePerTicket: 1.00},
            {name: "Chocolate $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Claw Enforcement $175", totalTickets: 280, idealProfit: 105, pricePerTicket: 1.00},
            {name: "Cotton Candy $100", totalTickets: 150, idealProfit: 50, pricePerTicket: 1.00},
            {name: "Cotton Candy $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Cotton Candy $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Cotton Candy $325", totalTickets: 500, idealProfit: 175, pricePerTicket: 1.00},
            {name: "Cotton Candy $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Cotton Candy $599", totalTickets: 840, idealProfit: 241, pricePerTicket: 1.00},
            {name: "Cotton Candy $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Crap Shoot $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Crap Shoot $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Crap Shoot $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Crap Shoot $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Crap Shoot $599", totalTickets: 840, idealProfit: 241, pricePerTicket: 1.00},
            {name: "Crap Shoot $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Dabbin' Dachsund $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Dabbin' Me Ma $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Day Dabbin' $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Dig Life $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Double Bubble $140", totalTickets: 200, idealProfit: 60, pricePerTicket: 1.00},
            {name: "Double Bubble $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Double Bubble $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Double Bubble $425", totalTickets: 600, idealProfit: 175, pricePerTicket: 1.00},
            {name: "Dumbo Dab $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Fire Fighters $140", totalTickets: 225, idealProfit: 85, pricePerTicket: 1.00},
            {name: "Fire Fighters $599", totalTickets: 960, idealProfit: 361, pricePerTicket: 1.00},
            {name: "Flamingo Bingo $140", totalTickets: 230, idealProfit: 90, pricePerTicket: 1.00},
            {name: "Funky Chicken $280", totalTickets: 445, idealProfit: 165, pricePerTicket: 1.00},
            {name: "Gator Dab $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Gator Dab $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Gator Dab $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Gator Dab $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Gotcha $140", totalTickets: 200, idealProfit: 60, pricePerTicket: 1.00},
            {name: "Gotcha $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Gotcha $425", totalTickets: 600, idealProfit: 175, pricePerTicket: 1.00},
            {name: "Gum Drops $100", totalTickets: 150, idealProfit: 50, pricePerTicket: 1.00},
            {name: "Gum Drops $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Gum Drops $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Gum Drops $325", totalTickets: 500, idealProfit: 175, pricePerTicket: 1.00},
            {name: "Gum Drops $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Gum Drops $599", totalTickets: 840, idealProfit: 241, pricePerTicket: 1.00},
            {name: "Gum Drops $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Hiss & Make Up $350", totalTickets: 550, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Jack $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Kick Grass $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Life Happens $599", totalTickets: 960, idealProfit: 361, pricePerTicket: 1.00},
            {name: "Lion Dab $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Lion Dab $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Lion Dab $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Lion Dab $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Lollipops $100", totalTickets: 150, idealProfit: 50, pricePerTicket: 1.00},
            {name: "Lollipops $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Lollipops $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Lollipops $325", totalTickets: 500, idealProfit: 175, pricePerTicket: 1.00},
            {name: "Lollipops $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Lollipops $599", totalTickets: 840, idealProfit: 241, pricePerTicket: 1.00},
            {name: "Lollipops $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Luckies $100", totalTickets: 140, idealProfit: 40, pricePerTicket: 1.00},
            {name: "Luckies $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Luckies $350", totalTickets: 550, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Luckies $500", totalTickets: 770, idealProfit: 270, pricePerTicket: 1.00},
            {name: "Mewsical $350", totalTickets: 550, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Monkey in the Middle $210", totalTickets: 300, idealProfit: 90, pricePerTicket: 1.00},
            {name: "Monkey See Monkey Do $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Monopoly Chance It $140", totalTickets: 230, idealProfit: 90, pricePerTicket: 1.00},
            {name: "Monopoly Chance It $280", totalTickets: 440, idealProfit: 160, pricePerTicket: 1.00},
            {name: "Monopoly Chance It $400", totalTickets: 660, idealProfit: 260, pricePerTicket: 1.00},
            {name: "Monopoly Chance It $599", totalTickets: 960, idealProfit: 361, pricePerTicket: 1.00},
            {name: "Mouse Keeping $350", totalTickets: 550, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Panda Dab $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Panda Dab $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Panda Dab $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Panda Dab $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Parrot Party $140", totalTickets: 230, idealProfit: 90, pricePerTicket: 1.00},
            {name: "Parrot Party $280", totalTickets: 445, idealProfit: 165, pricePerTicket: 1.00},
            {name: "Patriot Bingo $140", totalTickets: 200, idealProfit: 60, pricePerTicket: 1.00},
            {name: "Patriot Bingo $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Patriot Bingo $599", totalTickets: 840, idealProfit: 241, pricePerTicket: 1.00},
            {name: "Paws for the Cause $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Pot of Gold $140", totalTickets: 230, idealProfit: 90, pricePerTicket: 1.00},
            {name: "Pot of Gold $280", totalTickets: 440, idealProfit: 160, pricePerTicket: 1.00},
            {name: "Pot of Gold $400", totalTickets: 660, idealProfit: 260, pricePerTicket: 1.00},
            {name: "Purrsuasion $350", totalTickets: 550, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Quad Runner $100", totalTickets: 150, idealProfit: 50, pricePerTicket: 1.00},
            {name: "Quad Runner $130", totalTickets: 200, idealProfit: 70, pricePerTicket: 1.00},
            {name: "Quad Runner $140", totalTickets: 200, idealProfit: 60, pricePerTicket: 1.00},
            {name: "Quad Runner $165", totalTickets: 250, idealProfit: 85, pricePerTicket: 1.00},
            {name: "Quad Runner $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Quad Runner $210", totalTickets: 325, idealProfit: 115, pricePerTicket: 1.00},
            {name: "Quad Runner $260", totalTickets: 400, idealProfit: 140, pricePerTicket: 1.00},
            {name: "Quad Runner $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Quad Runner $390", totalTickets: 600, idealProfit: 210, pricePerTicket: 1.00},
            {name: "Quad Runner $500", totalTickets: 775, idealProfit: 275, pricePerTicket: 1.00},
            {name: "Race Horse Downs $250", totalTickets: 1000, idealProfit: 330, pricePerTicket: 1.00},
            {name: "Race Horse Downs $521", totalTickets: 2040, idealProfit: 615, pricePerTicket: 1.00},
            {name: "Red Hot Cardinals $140", totalTickets: 230, idealProfit: 90, pricePerTicket: 1.00},
            {name: "Rockin' Robin $140", totalTickets: 230, idealProfit: 90, pricePerTicket: 1.00},
            {name: "Roulette $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Roulette $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Roulette $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Roulette $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Roulette $599", totalTickets: 840, idealProfit: 241, pricePerTicket: 1.00},
            {name: "Roulette $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Shake it Off $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Slots $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Slots $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Slots $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Slots $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Slots $599", totalTickets: 840, idealProfit: 241, pricePerTicket: 1.00},
            {name: "Slots $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Smack Dab $270", totalTickets: 450, idealProfit: 180, pricePerTicket: 1.00},
            {name: "Small Ball $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Small Ball $200", totalTickets: 300, idealProfit: 100, pricePerTicket: 1.00},
            {name: "Small Ball $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Small Ball $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Small Ball $599", totalTickets: 840, idealProfit: 241, pricePerTicket: 1.00},
            {name: "Small Ball $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Snap Crackle Pop $270", totalTickets: 450, idealProfit: 180, pricePerTicket: 1.00},
            {name: "Stones $599", totalTickets: 960, idealProfit: 361, pricePerTicket: 1.00},
            {name: "Tiger Dab $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Tiger Dab $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Tiger Dab $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Tiger Dab $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00},
            {name: "Triple Twist $110", totalTickets: 150, idealProfit: 40, pricePerTicket: 1.00},
            {name: "Triple Twist $175", totalTickets: 250, idealProfit: 75, pricePerTicket: 1.00},
            {name: "Triple Twist $280", totalTickets: 400, idealProfit: 120, pricePerTicket: 1.00},
            {name: "Triple Twist $400", totalTickets: 600, idealProfit: 200, pricePerTicket: 1.00},
            {name: "Triple Twist $700", totalTickets: 1000, idealProfit: 300, pricePerTicket: 1.00}
        ];

        let pulltabGameCount = 15;

        // Session-specific game data based on legacy forms
        const occasionGameData = {
            '5-1': {
                games: {
                    4: {name: 'Regular Bingo or Outside 4 Corners (Blue)', color: 'Blue', prize: 100},
                    5: {name: '$250 Number 7 (Orange)', color: 'Orange', prize: 250},
                    6: {name: 'Small Diamond (Green)', color: 'Green', prize: 100},
                    7: {name: 'Crazy Picture Frame (Yellow)', color: 'Yellow', prize: 100},
                    8: {name: '$250 Letter X (Pink)', color: 'Pink', prize: 250},
                    10: {name: 'Baseball Diamond (Gray)', color: 'Gray', prize: 150},
                    11: {name: '6 Pack Anywhere (Olive)', color: 'Olive', prize: 150},
                    12: {name: 'Top or Bottom Line (Brown)', color: 'Brown', prize: 150},
                    14: {name: '3 on Top Row and 3 on Bottom Row (Red)', color: 'Red', prize: 150},
                    15: {name: 'Double Postage Stamp - Anywhere (Purple)', color: 'Purple', prize: 150},
                    16: {name: 'Small Kite (Black)', color: 'Black', prize: 150},
                    17: {name: '$500 Coverall (Aqua)', color: 'Aqua', prize: 500}
                }
            },
            '6-2': {
                games: {
                    4: {name: 'Block of 9 (Blue)', color: 'Blue', prize: 100},
                    5: {name: '$250 Number 7 (Orange)', color: 'Orange', prize: 250},
                    6: {name: 'Small Diamond (Green)', color: 'Green', prize: 100},
                    7: {name: 'Razor Blade (Yellow)', color: 'Yellow', prize: 100},
                    8: {name: '$250 Letter X (Pink)', color: 'Pink', prize: 250},
                    10: {name: '5 Around Any Corner (Gray)', color: 'Gray', prize: 150},
                    11: {name: 'Double Postage Stamps (Olive)', color: 'Olive', prize: 150},
                    12: {name: 'Outside Single Line (Brown)', color: 'Brown', prize: 150},
                    14: {name: 'Checkmark (Red)', color: 'Red', prize: 150},
                    15: {name: 'Regular Bingo No Corners (Purple)', color: 'Purple', prize: 150},
                    16: {name: 'Any 3 on Top Row and 3 on Bottom Row (Black)', color: 'Black', prize: 150},
                    17: {name: '$500 Coverall (Aqua)', color: 'Aqua', prize: 500}
                }
            },
            '7-3': {
                games: {
                    4: {name: 'Block of 9 (Blue)', color: 'Blue', prize: 100},
                    5: {name: '$250 Number 7 (Orange)', color: 'Orange', prize: 250},
                    6: {name: 'Small Diamond (Green)', color: 'Green', prize: 100},
                    7: {name: 'Crazy Picture Frame (Yellow)', color: 'Yellow', prize: 100},
                    8: {name: '$250 Letter X (Pink)', color: 'Pink', prize: 250},
                    10: {name: 'Baseball Diamond (Gray)', color: 'Gray', prize: 150},
                    11: {name: '6 Pack Anywhere (Olive)', color: 'Olive', prize: 150},
                    12: {name: 'Top or Bottom Line (Brown)', color: 'Brown', prize: 150},
                    14: {name: '3 on Top Row and 3 on Bottom Row (Red)', color: 'Red', prize: 150},
                    15: {name: 'Double Postage Stamp - Anywhere (Purple)', color: 'Purple', prize: 150},
                    16: {name: 'Small Kite (Black)', color: 'Black', prize: 150},
                    17: {name: '$500 Coverall (Aqua)', color: 'Aqua', prize: 500}
                }
            },
            '8-4': {
                games: {
                    4: {name: 'Regular Bingo or Outside 4 Corners (Blue)', color: 'Blue', prize: 100},
                    5: {name: '$250 Number 7 (Orange)', color: 'Orange', prize: 250},
                    6: {name: 'Small Diamond (Green)', color: 'Green', prize: 100},
                    7: {name: 'Razor Blade (Yellow)', color: 'Yellow', prize: 100},
                    8: {name: '$250 Letter X (Pink)', color: 'Pink', prize: 250},
                    10: {name: '5 Around Any Corner (Gray)', color: 'Gray', prize: 150},
                    11: {name: 'Double Postage Stamps (Olive)', color: 'Olive', prize: 150},
                    12: {name: 'Outside Single Line (Brown)', color: 'Brown', prize: 150},
                    14: {name: 'Checkmark (Red)', color: 'Red', prize: 150},
                    15: {name: 'Regular Bingo No Corners (Purple)', color: 'Purple', prize: 150},
                    16: {name: 'Any 3 on Top Row and 3 on Bottom Row (Black)', color: 'Black', prize: 150},
                    17: {name: '$500 Coverall (Aqua)', color: 'Aqua', prize: 500}
                }
            }
        };

        // Occasion Management
        function autoSelectOccasion() {
            const dateInput = document.getElementById('occasion_date');
            const occasionSelect = document.getElementById('occasion_type');

            if (dateInput.value) {
                const selectedDate = new Date(dateInput.value);
                const occasion = calculateOccasionFromDate(selectedDate);
                occasionSelect.value = occasion;
                updateOccasionDisplay();
                updateAllFormsWithOccasion();
            }
        }

        function calculateOccasionFromDate(date) {
            const month = date.getMonth();
            const year = date.getFullYear();

            // Get all Mondays in the month
            const mondays = [];

            // Find all Mondays in the month
            for (let d = 1; d <= 31; d++) {
                const testDate = new Date(year, month, d);
                if (testDate.getMonth() !== month) break; // Moved to next month
                if (testDate.getDay() === 1) { // Monday = 1
                    mondays.push(new Date(testDate));
                }
            }

            // Find which Monday this is (1-based index)
            for (let i = 0; i < mondays.length; i++) {
                if (mondays[i].getDate() === date.getDate()) {
                    const mondayNumber = i + 1; // 1st, 2nd, 3rd, 4th, or 5th
                    switch (mondayNumber) {
                        case 1: return '5-1'; // 1st Monday = Session 5-1
                        case 2: return '6-2'; // 2nd Monday = Session 6-2
                        case 3: return '7-3'; // 3rd Monday = Session 7-3
                        case 4: return '8-4'; // 4th Monday = Session 8-4
                        case 5: return '5-1'; // 5th Monday = Session 5-1 (same as 1st)
                        default: return '5-1';
                    }
                }
            }
            return '5-1'; // Default fallback
        }

        function updateOccasionDisplay() {
            const date = document.getElementById('occasion_date').value;
            const occasion = document.getElementById('occasion_type').value;
            const jackpot = document.getElementById('progressive_jackpot_setup').value;

            document.getElementById('display-date').textContent = date || 'Not Set';
            document.getElementById('display-occasion').textContent = occasion || 'Not Set';
            document.getElementById('display-jackpot').textContent = jackpot || '1000.00';

            updateAllFormsWithOccasion();
        }

        function updateAllFormsWithOccasion() {
            // Update all forms with occasion info
            updateOccasionGames(); // Update occasion games when occasion changes
            updateMetrics();
        }

        function updateBirthdayCalculations() {
            const birthdays = parseInt(document.getElementById('birthday_bogos').value) || 0;

            // Update birthday pack in POS
            document.getElementById('pos_birthday').value = birthdays;

            // Update free counts
            document.getElementById('eb_free').value = birthdays * 2; // 2 Early Birds per BOGO
            document.getElementById('six_free').value = birthdays; // 1 Six Face per BOGO

            calculateCounts();
            calculateDoorSales();
        }

        // Tab functionality
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Manual Counts calculations - FIXED FOR ALL ITEMS
        function calculateCounts() {
            const items = ['eb', 'six', 'solid', 'stripe', 'prog1', 'prog5'];

            items.forEach(item => {
                const start = parseInt(document.getElementById(`${item}_start`).value) || 0;
                const end = parseInt(document.getElementById(`${item}_end`).value) || 0;
                const free = parseInt(document.getElementById(`${item}_free`).value) || 0;
                const sold = Math.max(0, start - end - free);

                document.getElementById(`${item}_sold`).value = sold;
            });
        }

        // Door Sales calculations - FIXED ORDER
        function calculateDoorSales() {
            const items = [
                {id: 'small', price: 40.00},
                {id: 'large', price: 65.00},
                {id: 'six', price: 10.00},
                {id: 'solid', price: 15.00},
                {id: 'stripe', price: 10.00},
                {id: 'birthday', price: 0.00},
                {id: 'coverall_extra', price: 1.00},
                {id: 'eb', price: 5.00},
                {id: 'letterx_extra', price: 1.00},
                {id: 'number7_extra', price: 1.00},
                {id: 'prog18', price: 5.00},
                {id: 'prog3', price: 1.00},
                {id: 'daubers', price: 2.00}
            ];

            let totalBingoSales = 0;

            items.forEach(item => {
                const sold = parseInt(document.getElementById(`pos_${item.id}`).value) || 0;
                const total = sold * item.price;
                document.getElementById(`pos_${item.id}_total`).value = total.toFixed(2);
                totalBingoSales += total;
            });

            document.getElementById('total_bingo_sales').value = totalBingoSales.toFixed(2);
            updateMetrics();
        }

        // Game prize calculations
        function changeWinners(gameNum, change) {
            const winnersInput = document.getElementById(`game${gameNum}_winners`);
            let currentWinners = parseInt(winnersInput.value) || 1;
            currentWinners = Math.max(1, currentWinners + change);
            winnersInput.value = currentWinners;

            // Special handling for progressive game (game 13)
            if (gameNum === 13) {
                calculateProgressivePrize();
            } else {
                calculateGamePrize(gameNum);
            }
        }

        function calculateGamePrize(gameNum) {
            const prizeInput = document.getElementById(`game${gameNum}_prize`);
            const winnersInput = document.getElementById(`game${gameNum}_winners`);
            const perWinnerInput = document.getElementById(`game${gameNum}_per_winner`);

            const totalPrize = parseFloat(prizeInput.value) || 0;
            const winners = parseInt(winnersInput.value) || 1;

            if (totalPrize > 0 && winners > 0) {
                const prizePerWinner = Math.ceil(totalPrize / winners);
                perWinnerInput.value = prizePerWinner.toFixed(2);
            } else {
                perWinnerInput.value = '';
            }

            calculateGamesTotals();
        }

        function calculateProgressivePrize() {
            const jackpot = parseFloat(document.getElementById('progressive_jackpot_setup').value) || 1000;
            const targetBalls = parseInt(document.getElementById('progressive_balls_setup').value) || 17;
            const actualBalls = parseInt(document.getElementById('progressive_balls_actual').value) || targetBalls;
            const consolation = parseFloat(document.getElementById('progressive_consolation_setup').value) || 200;
            const winners = parseInt(document.getElementById('game13_winners').value) || 1;

            let totalPrize;
            if (actualBalls <= targetBalls) {
                totalPrize = jackpot;
            } else {
                totalPrize = consolation;
            }

            document.getElementById('progressive_prize_display').textContent = totalPrize.toFixed(2);
            const prizePerWinner = Math.ceil(totalPrize / winners);
            document.getElementById('game13_per_winner').value = prizePerWinner.toFixed(2);

            calculateGamesTotals();
        }

        function calculateGamesTotals() {
            let earlybirdTotal = 0;
            for (let i = 1; i <= 3; i++) {
                const prize = parseFloat(document.getElementById(`game${i}_prize`).value) || 0;
                earlybirdTotal += prize;
            }

            const regularGames = [4, 5, 6, 7, 8, 10, 11, 12, 14, 15, 16, 17];
            let regularTotal = 0;
            regularGames.forEach(gameNum => {
                const prize = parseFloat(document.getElementById(`game${gameNum}_prize`).value) || 0;
                regularTotal += prize;
            });

            // Special games
            const game9Prize = parseFloat(document.getElementById('game9_per_winner').value) || 0;
            const game13Prize = parseFloat(document.getElementById('game13_per_winner').value) || 0;
            const specialTotal = game9Prize + game13Prize;

            const totalBingoPrizes = earlybirdTotal + regularTotal + specialTotal;
            document.getElementById('total_bingo_prizes').value = totalBingoPrizes.toFixed(2);

            updateMetrics();
        }

        // Initialize regular games with session-specific data - FIXED
        function initializeRegularGames() {
            const regularGames = [4, 5, 6, 7, 8, 10, 11, 12, 14, 15, 16, 17];
            const tbody = document.getElementById('regular_games_body');
            tbody.innerHTML = '';

            // Get current occasion
            const currentOccasion = document.getElementById('occasion_type').value || '5-1';
            const occasionData = occasionGameData[currentOccasion] || occasionGameData['5-1'];

            regularGames.forEach(gameNum => {
                const gameData = occasionData.games[gameNum];
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${gameNum}</td>
                    <td><input type="text" id="game${gameNum}_name" value="${gameData.name}"></td>
                    <td><input type="number" step="0.01" id="game${gameNum}_prize" value="${gameData.prize}.00" onchange="calculateGamePrize(${gameNum})"></td>
                    <td>
                        <button class="btn btn-secondary no-print" onclick="changeWinners(${gameNum}, -1)">-</button>
                        <input type="number" id="game${gameNum}_winners" value="1" min="1" style="width: 40px; text-align: center;" onchange="calculateGamePrize(${gameNum})">
                        <button class="btn btn-secondary no-print" onclick="changeWinners(${gameNum}, 1)">+</button>
                    </td>
                    <td><input type="number" step="0.01" id="game${gameNum}_per_winner" readonly></td>
                `;
            });

            // Calculate initial totals
            regularGames.forEach(gameNum => calculateGamePrize(gameNum));
        }

        function updateOccasionGames() {
            const selectedOccasion = document.getElementById('occasion_type').value;
            if (selectedOccasion) {
                initializeRegularGames(); // Reinitialize with new occasion data
                calculateGamesTotals(); // Recalculate totals
            }
        }

        // Pull-tab functions - FIXED WITH COMPLETE LIBRARY
        function createGameDropdown(gameId) {
            let options = '<option value="">Select game or enter manually below</option>';
            gameLibrary.forEach((game, index) => {
                options += `<option value="${index}">${game.name}</option>`;
            });
            return `<select id="game_select_${gameId}" onchange="populateGameData(${gameId})" style="width: 100%; margin-bottom: 3px;">${options}</select>`;
        }

        function populateGameData(gameId) {
            const selectElement = document.getElementById(`game_select_${gameId}`);
            const selectedIndex = selectElement.value;

            if (selectedIndex !== '') {
                const gameData = gameLibrary[selectedIndex];

                // Populate all available fields from library
                document.getElementById(`game_name_${gameId}`).value = gameData.name;
                document.getElementById(`game_price_${gameId}`).value = gameData.pricePerTicket.toFixed(2);

                // Populate tickets field with total tickets from library
                if (gameData.totalTickets) {
                    document.getElementById(`game_tickets_${gameId}`).value = gameData.totalTickets;
                }

                // Populate prizes field with ideal profit from library
                if (gameData.idealProfit) {
                    document.getElementById(`game_prizes_${gameId}`).value = gameData.idealProfit.toFixed(2);
                }

                // Set placeholder for reference
                document.getElementById(`game_tickets_${gameId}`).placeholder = `Expected: ${gameData.totalTickets}`;

                // Auto-calculate sales and profit
                calculatePulltabGame(gameId);
            }
        }

        function initializePulltabGames() {
            const tbody = document.getElementById('pulltab_games_body');
            tbody.innerHTML = '';

            for (let i = 1; i <= pulltabGameCount; i++) {
                addPulltabGameRow(i);
            }

            // Add special event row
            const specialRow = tbody.insertRow();
            specialRow.innerHTML = `
                <td>
                    ${createGameDropdown('special')}
                    <input type="text" id="game_name_special" placeholder="Special Event Game" style="margin-top: 2px;">
                </td>
                <td><input type="text" id="game_serial_special" placeholder="Serial #"></td>
                <td><input type="number" step="0.01" id="game_price_special" value="1.00" onchange="calculatePulltabGame('special')"></td>
                <td><input type="number" id="game_tickets_special" placeholder="0" onchange="calculatePulltabGame('special')"></td>
                <td><input type="number" step="0.01" id="game_prizes_special" placeholder="0.00" onchange="calculatePulltabGame('special')"></td>
                <td><input type="number" step="0.01" id="game_sales_special" readonly></td>
                <td><input type="number" step="0.01" id="game_profit_special" readonly></td>
            `;
        }

        function addPulltabGameRow(num) {
            const tbody = document.getElementById('pulltab_games_body');
            const row = tbody.insertRow();
            row.innerHTML = `
                <td>
                    ${createGameDropdown(num)}
                    <input type="text" id="game_name_${num}" placeholder="Game ${num}" style="margin-top: 2px;">
                </td>
                <td><input type="text" id="game_serial_${num}" placeholder="Serial #"></td>
                <td><input type="number" step="0.01" id="game_price_${num}" value="1.00" onchange="calculatePulltabGame(${num})"></td>
                <td><input type="number" id="game_tickets_${num}" placeholder="0" onchange="calculatePulltabGame(${num})"></td>
                <td><input type="number" step="0.01" id="game_prizes_${num}" placeholder="0.00" onchange="calculatePulltabGame(${num})"></td>
                <td><input type="number" step="0.01" id="game_sales_${num}" readonly></td>
                <td><input type="number" step="0.01" id="game_profit_${num}" readonly></td>
            `;
        }

        function addPulltabGame() {
            if (pulltabGameCount < 20) {
                pulltabGameCount++;
                const tbody = document.getElementById('pulltab_games_body');
                const newRow = tbody.insertRow(tbody.rows.length - 1);
                newRow.innerHTML = `
                    <td>
                        ${createGameDropdown(pulltabGameCount)}
                        <input type="text" id="game_name_${pulltabGameCount}" placeholder="Game ${pulltabGameCount}" style="margin-top: 2px;">
                    </td>
                    <td><input type="text" id="game_serial_${pulltabGameCount}" placeholder="Serial #"></td>
                    <td><input type="number" step="0.01" id="game_price_${pulltabGameCount}" value="1.00" onchange="calculatePulltabGame(${pulltabGameCount})"></td>
                    <td><input type="number" id="game_tickets_${pulltabGameCount}" placeholder="0" onchange="calculatePulltabGame(${pulltabGameCount})"></td>
                    <td><input type="number" step="0.01" id="game_prizes_${pulltabGameCount}" placeholder="0.00" onchange="calculatePulltabGame(${pulltabGameCount})"></td>
                    <td><input type="number" step="0.01" id="game_sales_${pulltabGameCount}" readonly></td>
                    <td><input type="number" step="0.01" id="game_profit_${pulltabGameCount}" readonly></td>
                `;
            }
        }

        function removePulltabGame() {
            if (pulltabGameCount > 10) {
                const tbody = document.getElementById('pulltab_games_body');
                tbody.deleteRow(tbody.rows.length - 2);
                pulltabGameCount--;
            }
        }

        function calculatePulltabGame(gameId) {
            const ticketsSold = parseInt(document.getElementById(`game_tickets_${gameId}`).value) || 0;
            const prizesPaid = parseFloat(document.getElementById(`game_prizes_${gameId}`).value) || 0;
            const pricePerTicket = parseFloat(document.getElementById(`game_price_${gameId}`).value) || 1.00;

            const sales = ticketsSold * pricePerTicket;
            const profit = sales - prizesPaid;

            document.getElementById(`game_sales_${gameId}`).value = sales.toFixed(2);
            document.getElementById(`game_profit_${gameId}`).value = profit.toFixed(2);

            // If this is the special event game, update Session Games Sheet Game #9
            if (gameId === 'special') {
                const gameName = document.getElementById('game_name_special').value || 'Special Event Pull-tab';
                document.getElementById('game9_name').value = gameName;
                document.getElementById('game9_prize_display').value = prizesPaid.toFixed(2);
                calculateGamePrize(9);
            }

            calculatePulltabTotals();
        }

        function calculatePulltabTotals() {
            let totalSales = 0;
            let totalPrizes = 0;

            for (let i = 1; i <= pulltabGameCount; i++) {
                const sales = parseFloat(document.getElementById(`game_sales_${i}`).value) || 0;
                const prizes = parseFloat(document.getElementById(`game_prizes_${i}`).value) || 0;
                totalSales += sales;
                totalPrizes += prizes;
            }

            const specialSales = parseFloat(document.getElementById('game_sales_special').value) || 0;
            const specialPrizes = parseFloat(document.getElementById('game_prizes_special').value) || 0;
            totalSales += specialSales;
            totalPrizes += specialPrizes;

            const grossProfit = totalSales - totalPrizes;

            document.getElementById('pulltab_total_sales').value = totalSales.toFixed(2);
            document.getElementById('pulltab_total_prizes').value = totalPrizes.toFixed(2);
            document.getElementById('pulltab_gross_profit').value = grossProfit.toFixed(2);

            calculatePulltabMetrics();
        }

        function calculatePulltabMetrics() {
            const cashTurnedIn = parseFloat(document.getElementById('pulltab_cash_turned_in').value) || 0;
            const startupCash = parseFloat(document.getElementById('pulltab_startup').value) || 550;
            const netProfit = cashTurnedIn - startupCash;

            document.getElementById('pulltab_net_profit').value = netProfit.toFixed(2);

            updateMetrics();
        }

        // Money Summary calculations - FIXED TO USE CURRENCY AMOUNTS
        function calculateMoney() {
            const denominations = ['100s', '50s', '20s', '10s', '5s', '2s', '1s', 'quarters', 'dimes', 'nickels', 'pennies'];

            let bingoSubtotal = 0;
            let pulltabSubtotal = 0;

            denominations.forEach(denom => {
                const bingoVal = parseFloat(document.getElementById(`bingo_${denom}`).value) || 0;
                const pulltabVal = parseFloat(document.getElementById(`pulltab_${denom}`).value) || 0;
                const totalVal = bingoVal + pulltabVal;

                document.getElementById(`total_${denom}`).value = totalVal.toFixed(2);

                bingoSubtotal += bingoVal;
                pulltabSubtotal += pulltabVal;
            });

            const bingoChecks = parseFloat(document.getElementById('bingo_checks').value) || 0;
            const bingoTotal = bingoSubtotal + bingoChecks;
            const totalTotal = bingoTotal + pulltabSubtotal;

            document.getElementById('bingo_subtotal').value = bingoSubtotal.toFixed(2);
            document.getElementById('pulltab_subtotal').value = pulltabSubtotal.toFixed(2);
            document.getElementById('total_subtotal').value = (bingoSubtotal + pulltabSubtotal).toFixed(2);
            document.getElementById('total_checks').value = bingoChecks.toFixed(2);

            document.getElementById('bingo_total').value = bingoTotal.toFixed(2);
            document.getElementById('pulltab_total').value = pulltabSubtotal.toFixed(2);
            document.getElementById('grand_total').value = totalTotal.toFixed(2);

            updateMetrics();
        }

        // Metrics and Summary
        function updateMetrics() {
            const bingoSales = parseFloat(document.getElementById('total_bingo_sales').value) || 0;
            const pulltabSales = parseFloat(document.getElementById('pulltab_total_sales').value) || 0;
            const grossSales = bingoSales + pulltabSales;

            const bingoPrizes = parseFloat(document.getElementById('total_bingo_prizes').value) || 0;
            const pulltabPrizes = parseFloat(document.getElementById('pulltab_total_prizes').value) || 0;
            const totalPrizes = bingoPrizes + pulltabPrizes;

            const bingoProfit = bingoSales - bingoPrizes;
            const pulltabProfit = parseFloat(document.getElementById('pulltab_net_profit').value) || 0;
            const totalProfit = bingoProfit + pulltabProfit;

            const deposit = parseFloat(document.getElementById('grand_total').value) || 0;
            const players = parseInt(document.getElementById('total_players').value) || 1;
            const profitPerPlayer = totalProfit / players;

            // Update metrics display
            document.getElementById('metrics_bingo_sales').value = bingoSales.toFixed(2);
            document.getElementById('metrics_pulltab_sales').value = pulltabSales.toFixed(2);
            document.getElementById('metrics_gross_sales').value = grossSales.toFixed(2);
            document.getElementById('metrics_bingo_prizes').value = bingoPrizes.toFixed(2);
            document.getElementById('metrics_pulltab_prizes').value = pulltabPrizes.toFixed(2);
            document.getElementById('metrics_total_prizes').value = totalPrizes.toFixed(2);
            document.getElementById('metrics_bingo_profit').value = bingoProfit.toFixed(2);
            document.getElementById('metrics_pulltab_profit').value = pulltabProfit.toFixed(2);
            document.getElementById('metrics_total_profit').value = totalProfit.toFixed(2);
            document.getElementById('metrics_deposit').value = deposit.toFixed(2);
            document.getElementById('metrics_profit_per_player').value = profitPerPlayer.toFixed(2);

            // Update session details
            document.getElementById('metrics_date').value = document.getElementById('occasion_date').value || '';
            document.getElementById('metrics_occasion').value = document.getElementById('occasion_type').value || '';
            document.getElementById('metrics_players').value = document.getElementById('total_players').value || '';
            document.getElementById('metrics_birthdays').value = document.getElementById('birthday_bogos').value || '';
            document.getElementById('metrics_bingo_worker').value = document.getElementById('bingo_worker').value || '';
            document.getElementById('metrics_pulltabs_worker').value = document.getElementById('pulltabs_worker').value || '';

            const progressivePaid = parseFloat(document.getElementById('progressive_prize_display').textContent) || 0;
            document.getElementById('metrics_progressive').value = '$' + progressivePaid.toFixed(2);
        }

        // Print functions
        function printBlankPacket() {
            const qty = parseInt(document.getElementById('packetQty').value) || 1;

            // Print each form sequentially
            const forms = ['counts', 'pulltabs', 'games', 'money'];
            let currentForm = 0;

            function printNextForm() {
                if (currentForm < forms.length) {
                    printBlankForm(forms[currentForm]);
                    currentForm++;
                    setTimeout(printNextForm, 1000); // Delay between forms
                }
            }

            for (let i = 0; i < qty; i++) {
                setTimeout(() => {
                    currentForm = 0;
                    printNextForm();
                }, i * 5000); // Delay between complete packets
            }
        }

        function printBlankForm(formId) {
            document.body.classList.add('blank-form-print');
            document.querySelector(`#${formId}`).classList.add('print-active');

            const inputs = document.querySelectorAll(`#${formId} input`);
            const originalValues = {};

            inputs.forEach(input => {
                originalValues[input.id] = input.value;
                if (!input.readOnly && input.type !== 'hidden') {
                    input.value = '';
                    input.removeAttribute('value');
                }
            });

            window.print();

            inputs.forEach(input => {
                if (originalValues[input.id] !== undefined) {
                    input.value = originalValues[input.id];
                }
            });

            document.body.classList.remove('blank-form-print');
            document.querySelector(`#${formId}`).classList.remove('print-active');
        }

        function printPlayerSheets() {
            const qty = parseInt(document.getElementById('playerQty').value) || 5;
            alert(`Printing ${qty} player sheets (feature to be implemented)`);
        }

        function printCurrentTab() {
            const activeTab = document.querySelector('.tab-content.active').id;
            document.querySelector(`#${activeTab}`).classList.add('print-active');
            window.print();
            document.querySelector(`#${activeTab}`).classList.remove('print-active');
        }

        function generateFinalReport() {
            updateMetrics();

            const date = document.getElementById('occasion_date').value;
            const occasion = document.getElementById('occasion_type').value;
            const players = document.getElementById('total_players').value;
            const bingoSales = document.getElementById('metrics_bingo_sales').value;
            const pulltabSales = document.getElementById('metrics_pulltab_sales').value;
            const bingoProfit = document.getElementById('metrics_bingo_profit').value;
            const pulltabProfit = document.getElementById('metrics_pulltab_profit').value;
            const totalProfit = document.getElementById('metrics_total_profit').value;
            const deposit = document.getElementById('metrics_deposit').value;
            const profitPerPlayer = document.getElementById('metrics_profit_per_player').value;

            const message = `RLC Bingo ${date} Occasion ${occasion}: ${players} players, Bingo Sales $${bingoSales} (profit $${bingoProfit}), Pull-tab Sales $${pulltabSales} (profit $${pulltabProfit}), Total Profit $${totalProfit}, Deposit $${deposit}, $${profitPerPlayer}/player`;

            navigator.clipboard.writeText(message).then(() => {
                alert('Final report SMS copied to clipboard!\n\n' + message);
            }).catch(() => {
                const textArea = document.createElement('textarea');
                textArea.value = message;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Final report SMS copied to clipboard!\n\n' + message);
            });
        }

        function saveData() {
            const data = {};
            document.querySelectorAll('input, select').forEach(input => {
                if (input.id) {
                    if (input.type === 'radio' || input.type === 'checkbox') {
                        data[input.id] = input.checked;
                    } else {
                        data[input.id] = input.value;
                    }
                }
            });

            localStorage.setItem('bingoFormsData', JSON.stringify(data));
            localStorage.setItem('bingoFormsTimestamp', new Date().toISOString());
            alert('Session data saved successfully!');
        }

        function loadData() {
            const data = JSON.parse(localStorage.getItem('bingoFormsData') || '{}');
            const timestamp = localStorage.getItem('bingoFormsTimestamp');

            if (Object.keys(data).length === 0) {
                alert('No saved session data found.');
                return;
            }

            Object.keys(data).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    if (element.type === 'radio' || element.type === 'checkbox') {
                        element.checked = data[key];
                    } else {
                        element.value = data[key];
                    }
                }
            });

            // Recalculate everything
            calculateCounts();
            calculateDoorSales();
            calculateGamesTotals();
            calculatePulltabTotals();
            calculateMoney();
            updateOccasionDisplay();

            const savedDate = timestamp ? new Date(timestamp).toLocaleString() : 'Unknown';
            alert(`Session data loaded successfully!\nSaved: ${savedDate}`);
        }

        function generateSMS() {
            generateFinalReport();
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('occasion_date').value = today;
            autoSelectOccasion();

            initializePulltabGames();
            initializeRegularGames();

            // Initialize early bird and progressive prize calculations
            calculateGamePrize(1);
            calculateGamePrize(2);
            calculateGamePrize(3);
            calculateProgressivePrize();
        });
    </script>
</body>
</html>
