<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RLC Bingo Forms - Complete System v6</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            padding: 10px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        /* Tab Navigation */
        .tabs {
            display: flex;
            background: #2c3e50;
            border-radius: 8px 8px 0 0;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 12px 20px;
            background: none;
            border: none;
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.3s;
            white-space: nowrap;
        }

        .tab-button:hover {
            background: rgba(255,255,255,0.1);
        }

        .tab-button.active {
            background: #3498db;
        }

        .tab-content {
            display: none;
            padding: 20px;
            animation: fadeIn 0.3s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Form Styles */
        h1, h2, h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        h1 {
            text-align: center;
            font-size: 24px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }

        h2 {
            font-size: 18px;
            margin-top: 20px;
        }

        .form-section {
            margin-bottom: 20px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: bold;
            margin-bottom: 3px;
            color: #555;
            font-size: 12px;
        }

        input[type="text"],
        input[type="number"],
        input[type="date"],
        select {
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 13px;
        }

        input[type="radio"], input[type="checkbox"] {
            margin-right: 5px;
        }

        .radio-group {
            display: flex;
            gap: 15px;
            padding: 8px;
            flex-wrap: wrap;
        }

        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 13px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 6px;
            text-align: left;
        }

        th {
            background: #f8f9fa;
            font-weight: bold;
            font-size: 12px;
        }

        td input {
            width: 100%;
            border: none;
            padding: 3px;
            font-size: 12px;
        }

        td input[type="number"] {
            text-align: right;
        }

        .currency-input {
            display: flex;
            align-items: center;
            gap: 2px;
        }

        .currency-input span {
            font-weight: bold;
        }

        .currency-input input {
            flex: 1;
            text-align: right;
        }

        .total-row {
            background: #e3f2fd;
            font-weight: bold;
        }

        .grand-total {
            background: #bbdefb;
            font-weight: bold;
            font-size: 14px;
        }

        /* Narrow columns for specific tables */
        .narrow-col {
            width: 60px;
        }

        .medium-col {
            width: 100px;
        }

        .wide-col {
            width: 150px;
        }

        /* Button Styles */
        .button-group {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        button {
            padding: 10px 20px;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: background 0.3s;
        }

        button:hover {
            background: #2980b9;
        }

        button.secondary {
            background: #95a5a6;
        }

        button.secondary:hover {
            background: #7f8c8d;
        }

        button.success {
            background: #27ae60;
        }

        button.success:hover {
            background: #229954;
        }

        button.warning {
            background: #e67e22;
        }

        button.warning:hover {
            background: #d35400;
        }

        button.danger {
            background: #e74c3c;
        }

        button.danger:hover {
            background: #c0392b;
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
            }

            .tabs, .button-group, .no-print {
                display: none !important;
            }

            .tab-content {
                display: block !important;
                page-break-after: always;
            }

            .tab-content:last-child {
                page-break-after: auto;
            }

            input {
                border: 1px solid #ccc !important;
            }

            h1 {
                font-size: 20px;
            }

            h2 {
                font-size: 16px;
            }

            table {
                font-size: 11px;
            }
        }

        /* Instructions Box */
        .instructions {
            background: #ecf0f1;
            border-left: 4px solid #3498db;
            padding: 12px;
            margin: 15px 0;
            border-radius: 4px;
            font-size: 12px;
        }

        .letter-label {
            display: inline-block;
            width: 25px;
            font-weight: bold;
            color: #e74c3c;
        }

        /* Progressive Section */
        .progressive-section {
            background: #f0f8ff;
            border: 2px solid #3498db;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }

        /* Special Event Highlight */
        .special-event {
            background: #fff3cd !important;
        }

        /* Checkbox styling */
        .check-col {
            width: 40px;
            text-align: center;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            table {
                font-size: 11px;
            }

            td, th {
                padding: 4px;
            }
        }

        /* Number spinner styling */
        .winner-count {
            width: 50px;
            text-align: center;
        }

        /* Status indicators */
        .status-good {
            color: green;
            font-weight: bold;
        }

        .status-bad {
            color: red;
            font-weight: bold;
        }

        /* Summary Box */
        .summary-box {
            background: #f8f9fa;
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .summary-item {
            padding: 10px;
            background: white;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .summary-label {
            font-size: 11px;
            color: #666;
            margin-bottom: 3px;
        }

        .summary-value {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
        }

        /* Blank form letter indicators */
        .blank-indicator {
            display: none;
            color: #e74c3c;
            font-weight: bold;
            margin-right: 5px;
        }

        .blank-form .blank-indicator {
            display: inline;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Tab Navigation -->
        <div class="tabs">
            <button class="tab-button active" onclick="showTab('occasion')">Bingo Occasion Report</button>
            <button class="tab-button" onclick="showTab('games')">Session Games Sheet</button>
            <button class="tab-button" onclick="showTab('pulltab')">Pull-Tab Summary</button>
            <button class="tab-button" onclick="showTab('money')">Money Summary</button>
        </div>

        <!-- Master Print Controls -->
        <div class="button-group no-print" style="padding: 10px 20px; background: #ecf0f1;">
            <button class="success" onclick="printAllForms('completed')">Print All Forms (Completed)</button>
            <button onclick="printAllForms('blank')">Print All Forms (Blank)</button>
            <button class="secondary" onclick="printCurrentTab('completed')">Print Current Tab (Completed)</button>
            <button class="secondary" onclick="printCurrentTab('blank')">Print Current Tab (Blank)</button>
        </div>

        <!-- Bingo Occasion Report Tab -->
        <div id="occasion" class="tab-content active">
            <h1>BINGO OCCASION REPORT</h1>
            
            <div class="form-section">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Date:</label>
                        <input type="date" id="occ-date" onchange="syncDate(); determineSession()">
                    </div>
                    <div class="form-group">
                        <label>Lion:</label>
                        <input type="text" id="occ-lion" onchange="syncLion()">
                    </div>
                    <div class="form-group">
                        <label>Total People:</label>
                        <input type="number" id="occ-people" onchange="calculateMetrics()">
                    </div>
                    <div class="form-group">
                        <label>Birthdays (BOGOs):</label>
                        <input type="number" id="occ-birthdays" onchange="calculateBirthdayBOGO()">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Session (Which Monday):</label>
                    <div class="radio-group">
                        <label><input type="radio" name="session" value="5-1" onchange="loadSessionGames()"> 5-1 (1st/5th Monday)</label>
                        <label><input type="radio" name="session" value="6-2" onchange="loadSessionGames()"> 6-2 (2nd Monday)</label>
                        <label><input type="radio" name="session" value="7-3" onchange="loadSessionGames()"> 7-3 (3rd Monday)</label>
                        <label><input type="radio" name="session" value="8-4" onchange="loadSessionGames()"> 8-4 (4th Monday)</label>
                    </div>
                </div>
            </div>

            <div class="progressive-section">
                <h3>Progressive Game Information</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Progressive Jackpot Offered:</label>
                        <input type="number" id="prog-jackpot" step="1" value="">
                    </div>
                    <div class="form-group">
                        <label>Balls to Win Jackpot:</label>
                        <input type="number" id="prog-balls-needed" step="1" value="">
                    </div>
                    <div class="form-group">
                        <label>Consolation Prize:</label>
                        <input type="number" id="prog-consolation" value="200">
                    </div>
                    <div class="form-group">
                        <label>Actual Balls Called:</label>
                        <input type="number" id="prog-actual-balls" onchange="calculateProgressivePrize()">
                    </div>
                    <div class="form-group">
                        <label>Actual Prize Awarded:</label>
                        <input type="number" id="prog-actual-prize" readonly style="background: #e8f4fd;">
                    </div>
                    <div class="form-group">
                        <label style="margin-top: 15px;">
                            <input type="checkbox" id="prog-check-payment"> Paid by Check
                        </label>
                    </div>
                </div>
            </div>

            <h2>PAPER BINGO SALES (Beginning & Ending Counts)</h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th class="medium-col"><span class="blank-indicator">A.</span>Start</th>
                        <th class="medium-col"><span class="blank-indicator">B.</span>Free</th>
                        <th class="medium-col"><span class="blank-indicator">C.</span>End</th>
                        <th class="medium-col"><span class="blank-indicator">D.</span>Sold</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Early Birds</td>
                        <td><input type="number" id="eb-start" value="" onchange="calculatePaperSales()"></td>
                        <td><input type="number" id="eb-free" readonly style="background: #f0f0f0;"></td>
                        <td><input type="number" id="eb-end" onchange="calculatePaperSales()"></td>
                        <td id="eb-sold" style="font-weight: bold;">0</td>
                    </tr>
                    <tr>
                        <td>6 Face</td>
                        <td><input type="number" id="6f-start" value="" onchange="calculatePaperSales()"></td>
                        <td><input type="number" id="6f-free" readonly style="background: #f0f0f0;"></td>
                        <td><input type="number" id="6f-end" onchange="calculatePaperSales()"></td>
                        <td id="6f-sold" style="font-weight: bold;">0</td>
                    </tr>
                    <tr>
                        <td>9 Face Solid Border</td>
                        <td><input type="number" id="9fs-start" value="" onchange="calculatePaperSales()"></td>
                        <td style="text-align: center;">-</td>
                        <td><input type="number" id="9fs-end" onchange="calculatePaperSales()"></td>
                        <td id="9fs-sold" style="font-weight: bold;">0</td>
                    </tr>
                    <tr>
                        <td>9 Face Stripe Border</td>
                        <td><input type="number" id="9fst-start" value="" onchange="calculatePaperSales()"></td>
                        <td style="text-align: center;">-</td>
                        <td><input type="number" id="9fst-end" onchange="calculatePaperSales()"></td>
                        <td id="9fst-sold" style="font-weight: bold;">0</td>
                    </tr>
                    <tr>
                        <td>Progressive 3 Face ($1)</td>
                        <td><input type="number" id="p3-start" value="" onchange="calculatePaperSales()"></td>
                        <td style="text-align: center;">-</td>
                        <td><input type="number" id="p3-end" onchange="calculatePaperSales()"></td>
                        <td id="p3-sold" style="font-weight: bold;">0</td>
                    </tr>
                    <tr>
                        <td>Progressive 18 Face ($5)</td>
                        <td><input type="number" id="p18-start" value="" onchange="calculatePaperSales()"></td>
                        <td style="text-align: center;">-</td>
                        <td><input type="number" id="p18-end" onchange="calculatePaperSales()"></td>
                        <td id="p18-sold" style="font-weight: bold;">0</td>
                    </tr>
                </tbody>
            </table>

            <h2>FROM POS DOOR SALES SUMMARY (Direct Entry)</h2>
            <table>
                <thead>
                    <tr>
                        <th>Item</th>
                        <th class="medium-col">Price</th>
                        <th class="medium-col"><span class="blank-indicator">E.</span>Net Sold</th>
                        <th class="medium-col"><span class="blank-indicator">F.</span>Net Sales</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>6 Face</td>
                        <td>$10.00</td>
                        <td><input type="number" id="6face-net" onchange="calculateOccasionTotals()"></td>
                        <td id="6face-sales" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr>
                        <td>9 Face Solid</td>
                        <td>$15.00</td>
                        <td><input type="number" id="9solid-net" onchange="calculateOccasionTotals()"></td>
                        <td id="9solid-sales" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr>
                        <td>9 Face Stripe</td>
                        <td>$10.00</td>
                        <td><input type="number" id="9stripe-net" onchange="calculateOccasionTotals()"></td>
                        <td id="9stripe-sales" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr>
                        <td>Birthday Pack (BOGO)</td>
                        <td>$0.00</td>
                        <td><input type="number" id="birthday-pack-net" readonly style="background: #f0f0f0;"></td>
                        <td id="birthday-pack-sales" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr>
                        <td>Coverall Extra</td>
                        <td>$1.00</td>
                        <td><input type="number" id="coverall-net" onchange="calculateOccasionTotals()"></td>
                        <td id="coverall-sales" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr>
                        <td>Early Bird Double</td>
                        <td>$5.00</td>
                        <td><input type="number" id="ebd-net" onchange="calculateOccasionTotals()"></td>
                        <td id="ebd-sales" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr>
                        <td>Letter X Extra</td>
                        <td>$1.00</td>
                        <td><input type="number" id="letterx-net" onchange="calculateOccasionTotals()"></td>
                        <td id="letterx-sales" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr>
                        <td>Number 7 Extra</td>
                        <td>$1.00</td>
                        <td><input type="number" id="number7-net" onchange="calculateOccasionTotals()"></td>
                        <td id="number7-sales" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr>
                        <td>Progressive 18 Face</td>
                        <td>$5.00</td>
                        <td><input type="number" id="prog18-net" onchange="calculateOccasionTotals()"></td>
                        <td id="prog18-sales" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr>
                        <td>Progressive 3 Face</td>
                        <td>$1.00</td>
                        <td><input type="number" id="prog3-net" onchange="calculateOccasionTotals()"></td>
                        <td id="prog3-sales" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr class="total-row">
                        <td colspan="3">TOTAL PAPER SALES</td>
                        <td id="total-paper-sales" style="font-weight: bold;">$0.00</td>
                    </tr>
                </tbody>
            </table>

            <h2>ELECTRONIC BINGO</h2>
            <table>
                <thead>
                    <tr>
                        <th>Item</th>
                        <th class="medium-col">Price</th>
                        <th class="medium-col"><span class="blank-indicator">G.</span>Quantity</th>
                        <th class="medium-col"><span class="blank-indicator">H.</span>Total</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Small Machines (27reg18pro)</td>
                        <td>$40.00</td>
                        <td><input type="number" id="small-machines" onchange="calculateOccasionTotals()"></td>
                        <td id="small-machines-total" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr>
                        <td>Large Machines (45reg36pro)</td>
                        <td>$65.00</td>
                        <td><input type="number" id="large-machines" onchange="calculateOccasionTotals()"></td>
                        <td id="large-machines-total" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr class="total-row">
                        <td colspan="3">TOTAL ELECTRONIC SALES</td>
                        <td id="total-electronic-sales" style="font-weight: bold;">$0.00</td>
                    </tr>
                </tbody>
            </table>

            <h2>MISCELLANEOUS</h2>
            <table>
                <thead>
                    <tr>
                        <th>Item</th>
                        <th class="narrow-col">Price</th>
                        <th class="narrow-col"><span class="blank-indicator">I.</span>Quantity</th>
                        <th class="medium-col"><span class="blank-indicator">J.</span>Total</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Daubers</td>
                        <td>$2.00</td>
                        <td><input type="number" id="daubers" onchange="calculateOccasionTotals()"></td>
                        <td id="daubers-total" style="font-weight: bold;">$0.00</td>
                    </tr>
                    <tr class="total-row">
                        <td colspan="3">TOTAL MISCELLANEOUS</td>
                        <td id="total-misc" style="font-weight: bold;">$0.00</td>
                    </tr>
                </tbody>
            </table>

            <h2>FINANCIAL SUMMARY</h2>
            <table>
                <tr>
                    <td style="width: 50%;"><span class="blank-indicator">K.</span>Total Bingo Sales</td>
                    <td id="occ-total-bingo" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">L.</span>Pull-Tab Sales</td>
                    <td id="occ-pulltab-sales" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">M.</span>Special Event Game</td>
                    <td id="occ-event-game" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr class="total-row">
                    <td><span class="blank-indicator">N.</span>Total Gross Sales</td>
                    <td id="occ-gross-sales" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">O.</span>Bingo Prizes Paid</td>
                    <td id="occ-bingo-prizes" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">P.</span>Pull-Tab Prizes Paid</td>
                    <td id="occ-pulltab-prizes" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">Q.</span>Special Event Prizes</td>
                    <td id="occ-event-prizes" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr class="total-row">
                    <td><span class="blank-indicator">R.</span>Total Prizes Paid</td>
                    <td id="occ-total-prizes" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">S.</span>Prizes Paid by Check</td>
                    <td id="occ-check-prizes" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">T.</span>Total Cash Deposit</td>
                    <td id="occ-cash-deposit" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">U.</span>Less Start Up Cash</td>
                    <td style="font-weight: bold;">-$1,000.00</td>
                </tr>
                <tr class="grand-total">
                    <td><span class="blank-indicator">V.</span>Actual Profit (T - U)</td>
                    <td id="occ-net-deposit" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">W.</span>Ideal Profit (N - R)</td>
                    <td id="occ-expected" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">X.</span>Over/Short</td>
                    <td id="occ-overshort" style="font-weight: bold;">$0.00</td>
                </tr>
            </table>

            <!-- Performance Metrics Summary -->
            <div class="summary-box no-print">
                <h3>Performance Metrics</h3>
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-label">Total Players</div>
                        <div class="summary-value" id="metric-players">0</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Gross Sales</div>
                        <div class="summary-value" id="metric-gross">$0.00</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Net Profit</div>
                        <div class="summary-value" id="metric-profit">$0.00</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Profit per Player</div>
                        <div class="summary-value" id="metric-per-player">$0.00</div>
                    </div>
                </div>
                <div class="button-group" style="margin-top: 15px;">
                    <button onclick="copyMetricsToClipboard()">Copy Metrics for Email</button>
                </div>
            </div>

            <div class="button-group">
                <button class="success" onclick="calculateOccasionTotals()">Calculate Totals</button>
                <button class="warning" onclick="clearAllData()">Clear All Data</button>
            </div>
        </div>

        <!-- Session Games Sheet Tab -->
        <div id="games" class="tab-content">
            <h1>SESSION GAMES SHEET</h1>
            
            <div class="form-section">
                <h3 id="session-title">Session 6-2 - Rolla Lions Club Bingo</h3>
                <p style="margin: 10px 0;">Event games start at 5:00. Closet opens at 5:45. Bingo starts at 6:45.</p>
            </div>

            <table id="games-table">
                <thead>
                    <tr>
                        <th style="width: 40px;">#</th>
                        <th style="width: 80px;">Color</th>
                        <th>Game</th>
                        <th style="width: 80px;">Prize</th>
                        <th class="narrow-col"><span class="blank-indicator">A.</span>Winners</th>
                        <th class="medium-col"><span class="blank-indicator">B.</span>Prize/Winner</th>
                        <th class="medium-col"><span class="blank-indicator">C.</span>Total Payout</th>
                        <th class="check-col"><span class="blank-indicator">D.</span>Check</th>
                    </tr>
                </thead>
                <tbody id="games-tbody">
                    <!-- Games will be populated here -->
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td colspan="6">TOTAL BINGO PRIZES</td>
                        <td id="games-total" style="font-weight: bold;">$0.00</td>
                        <td></td>
                    </tr>
                    <tr class="total-row">
                        <td colspan="6">PRIZES PAID BY CHECK</td>
                        <td id="games-check-total" style="font-weight: bold;">$0.00</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>

            <div class="button-group">
                <button class="success" onclick="calculateGameTotals()">Calculate Totals</button>
                <button onclick="transferBingoPrizes()">Transfer to Occasion Report</button>
            </div>
        </div>

        <!-- Pull-Tab Nightly Summary Tab -->
        <div id="pulltab" class="tab-content">
            <h1>PULL-TAB NIGHTLY SUMMARY</h1>
            
            <div class="form-section">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Date:</label>
                        <input type="date" id="pt-date">
                    </div>
                    <div class="form-group">
                        <label>Lion in Charge of Pull-Tabs:</label>
                        <input type="text" id="pt-lion">
                    </div>
                </div>
            </div>

            <h2>Pull-Tab Games</h2>
            <table id="pulltab-games">
                <thead>
                    <tr>
                        <th class="wide-col">Game Name</th>
                        <th class="medium-col">Serial Number</th>
                        <th class="narrow-col">$/Ticket</th>
                        <th class="narrow-col"><span class="blank-indicator">A.</span>Tickets</th>
                        <th class="medium-col"><span class="blank-indicator">B.</span>Sales</th>
                        <th class="medium-col"><span class="blank-indicator">C.</span>Ideal Profit</th>
                        <th class="medium-col"><span class="blank-indicator">D.</span>Prizes Paid</th>
                        <th class="medium-col"><span class="blank-indicator">E.</span>Net Profit</th>
                        <th class="check-col"><span class="blank-indicator">F.</span>Check</th>
                    </tr>
                </thead>
                <tbody id="pt-games-body">
                    <!-- Games will be added here -->
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td colspan="4">REGULAR GAMES TOTALS</td>
                        <td id="pt-reg-sales">$0.00</td>
                        <td id="pt-reg-ideal">$0.00</td>
                        <td id="pt-reg-prizes">$0.00</td>
                        <td id="pt-reg-net">$0.00</td>
                        <td></td>
                    </tr>
                    <tr class="special-event total-row">
                        <td colspan="4">SPECIAL EVENT TOTALS</td>
                        <td id="pt-se-sales">$0.00</td>
                        <td id="pt-se-ideal">$0.00</td>
                        <td id="pt-se-prizes">$0.00</td>
                        <td id="pt-se-net">$0.00</td>
                        <td></td>
                    </tr>
                    <tr class="grand-total">
                        <td colspan="4">GRAND TOTALS</td>
                        <td id="pt-total-sales">$0.00</td>
                        <td id="pt-total-ideal">$0.00</td>
                        <td id="pt-total-prizes">$0.00</td>
                        <td id="pt-total-net">$0.00</td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>

            <div class="button-group">
                <button onclick="addPullTabGame()">Add Regular Game</button>
                <button class="warning" onclick="addSpecialEventGame()">Add Special Event</button>
                <button class="secondary" onclick="clearPullTabGames()">Clear All</button>
            </div>

            <h2>Money Turned In</h2>
            <table style="width: 400px;">
                <tr>
                    <td><span class="blank-indicator">G.</span>Hundreds</td>
                    <td class="currency-input">
                        <span>$</span>
                        <input type="number" id="pt-hundreds" step="100" onchange="calculatePullTabCash()">
                    </td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">H.</span>Fifties</td>
                    <td class="currency-input">
                        <span>$</span>
                        <input type="number" id="pt-fifties" step="50" onchange="calculatePullTabCash()">
                    </td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">I.</span>Twenties</td>
                    <td class="currency-input">
                        <span>$</span>
                        <input type="number" id="pt-twenties" step="20" onchange="calculatePullTabCash()">
                    </td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">J.</span>Tens</td>
                    <td class="currency-input">
                        <span>$</span>
                        <input type="number" id="pt-tens" step="10" onchange="calculatePullTabCash()">
                    </td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">K.</span>Fives</td>
                    <td class="currency-input">
                        <span>$</span>
                        <input type="number" id="pt-fives" step="5" onchange="calculatePullTabCash()">
                    </td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">L.</span>Ones</td>
                    <td class="currency-input">
                        <span>$</span>
                        <input type="number" id="pt-ones" step="1" onchange="calculatePullTabCash()">
                    </td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">M.</span>Coins</td>
                    <td class="currency-input">
                        <span>$</span>
                        <input type="number" id="pt-coins" step="0.01" onchange="calculatePullTabCash()">
                    </td>
                </tr>
                <tr class="total-row">
                    <td><span class="blank-indicator">N.</span>DEPOSIT TOTAL</td>
                    <td id="pt-deposit-total" style="font-weight: bold;">$0.00</td>
                </tr>
            </table>

            <table style="width: 400px; margin-top: 20px;">
                <tr>
                    <td><span class="blank-indicator">O.</span>Turn In Amount</td>
                    <td id="pt-turnin" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">P.</span>Less Start Up</td>
                    <td style="font-weight: bold;">-$550.00</td>
                </tr>
                <tr class="total-row">
                    <td><span class="blank-indicator">Q.</span>NET TOTAL</td>
                    <td id="pt-net-total" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">R.</span>Expected (from games)</td>
                    <td id="pt-expected" style="font-weight: bold;">$0.00</td>
                </tr>
                <tr>
                    <td><span class="blank-indicator">S.</span>Over/Short</td>
                    <td id="pt-overshort" style="font-weight: bold;">$0.00</td>
                </tr>
            </table>

            <div class="button-group">
                <button class="success" onclick="calculatePullTabTotals()">Calculate Totals</button>
                <button onclick="transferPullTabTotals()">Transfer to Occasion Report</button>
            </div>
        </div>

        <!-- Money Summary Sheet Tab -->
        <div id="money" class="tab-content">
            <h1>MONEY SUMMARY SHEET</h1>
            
            <div class="form-section">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Date:</label>
                        <input type="date" id="ms-date">
                    </div>
                    <div class="form-group">
                        <label>Lion:</label>
                        <input type="text" id="ms-lion">
                    </div>
                </div>
            </div>

            <div class="instructions">
                <strong>Reminder:</strong> Write a check for next week's startup cash:
                <ul style="margin-left: 20px; margin-top: 8px;">
                    <li>Pay to: "T&C Bank for Bingo Cash"</li>
                    <li>Amount: $1,000.00</li>
                    <li>Memo: "For Bingo [next session date]"</li>
                </ul>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                <!-- Bingo Drawer -->
                <div>
                    <h2>BINGO</h2>
                    <table>
                        <tr>
                            <td><span class="letter-label">A.</span> $100's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="bingo-100" step="100" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">B.</span> $50's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="bingo-50" step="50" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">C.</span> $20's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="bingo-20" step="20" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">D.</span> $10's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="bingo-10" step="10" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">E.</span> $5's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="bingo-5" step="5" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">F.</span> $2's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="bingo-2" step="2" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">G.</span> $1's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="bingo-1" step="1" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">H.</span> Coins</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="bingo-coins" step="0.01" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">I.</span> Checks</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="bingo-checks" step="0.01" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr class="total-row">
                            <td>SUB-TOTAL</td>
                            <td id="bingo-subtotal" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr class="grand-total">
                            <td>TOTAL</td>
                            <td id="bingo-total" style="font-weight: bold;">$0.00</td>
                        </tr>
                    </table>
                </div>

                <!-- Pull-Tabs Drawer -->
                <div>
                    <h2>PULL-TABS</h2>
                    <table>
                        <tr>
                            <td><span class="letter-label">J.</span> $100's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="pulltab-100" step="100" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">K.</span> $50's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="pulltab-50" step="50" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">L.</span> $20's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="pulltab-20" step="20" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">M.</span> $10's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="pulltab-10" step="10" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">N.</span> $5's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="pulltab-5" step="5" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">O.</span> $2's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="pulltab-2" step="2" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">P.</span> $1's</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="pulltab-1" step="1" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td><span class="letter-label">Q.</span> Coins</td>
                            <td class="currency-input">
                                <span>$</span>
                                <input type="number" id="pulltab-coins" step="0.01" onchange="calculateMoneyTotals()">
                            </td>
                        </tr>
                        <tr>
                            <td>Checks</td>
                            <td style="text-align: center;">N/A</td>
                        </tr>
                        <tr class="total-row">
                            <td>SUB-TOTAL</td>
                            <td id="pulltab-subtotal" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr class="grand-total">
                            <td>TOTAL</td>
                            <td id="pulltab-total" style="font-weight: bold;">$0.00</td>
                        </tr>
                    </table>
                </div>

                <!-- Combined Totals -->
                <div>
                    <h2>TOTALS</h2>
                    <table>
                        <tr>
                            <td>$100's</td>
                            <td id="total-100" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr>
                            <td>$50's</td>
                            <td id="total-50" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr>
                            <td>$20's</td>
                            <td id="total-20" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr>
                            <td>$10's</td>
                            <td id="total-10" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr>
                            <td>$5's</td>
                            <td id="total-5" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr>
                            <td>$2's</td>
                            <td id="total-2" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr>
                            <td>$1's</td>
                            <td id="total-1" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr>
                            <td>Coins</td>
                            <td id="total-coins" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr>
                            <td>Checks</td>
                            <td id="total-checks" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr class="total-row">
                            <td>SUB-TOTAL</td>
                            <td id="grand-subtotal" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr class="grand-total">
                            <td>TOTAL DEPOSIT</td>
                            <td id="grand-total" style="font-weight: bold;">$0.00</td>
                        </tr>
                    </table>

                    <h3 style="margin-top: 15px;">Deposit Summary</h3>
                    <table>
                        <tr>
                            <td>Currency</td>
                            <td id="deposit-currency" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr>
                            <td>Coin</td>
                            <td id="deposit-coin" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr>
                            <td>Checks</td>
                            <td id="deposit-checks" style="font-weight: bold;">$0.00</td>
                        </tr>
                        <tr class="grand-total">
                            <td>TOTAL</td>
                            <td id="deposit-total" style="font-weight: bold;">$0.00</td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="button-group">
                <button class="success" onclick="calculateMoneyTotals()">Calculate Totals</button>
                <button onclick="transferToOccasion()">Transfer to Occasion Report</button>
            </div>
        </div>
    </div>

    <script>
	
        // Global variables for data sharing
        let sessionGames = {};
        let pullTabData = {
            regularSales: 0,
            regularPrizes: 0,
            specialSales: 0,
            specialPrizes: 0,
            checkPayments: 0
        };
        let bingoCheckPayments = 0;

        // Session Games Data
        const sessionsData = {
            '5-1': [
                {num: 1, color: 'Early Bird', game: 'Hard Way Bingo No Free Space', prize: 100},
                {num: 2, color: 'Early Bird', game: 'Diagonal & Outside Corners', prize: 100},
                {num: 3, color: 'Early Bird', game: 'Small Picture Frame', prize: 100},
                {num: 4, color: 'Blue', game: 'Regular Bingo or Outside 4 Corners', prize: 100},
                {num: 5, color: 'Orange', game: '$250 Number 7', prize: 250},
                {num: 6, color: 'Green', game: 'Small Diamond', prize: 100},
                {num: 7, color: 'Yellow', game: 'Crazy Picture Frame', prize: 100},
                {num: 8, color: 'Pink', game: '$250 Letter X', prize: 250},
                {num: 9, color: '', game: 'Event Game - Pot of Gold, etc.', prize: 0, special: true},
                {num: 10, color: 'Gray', game: 'Baseball Diamond', prize: 150},
                {num: 11, color: 'Olive', game: '6 Pack Anywhere', prize: 150},
                {num: 12, color: 'Brown', game: 'Top or Bottom Line', prize: 150},
                {num: 13, color: 'Progressive', game: 'Diamond', prize: 0, progressive: true},
                {num: 14, color: 'Red', game: '3 on Top Row and 3 on Bottom Row', prize: 150},
                {num: 15, color: 'Purple', game: 'Double Postage Stamp - Anywhere', prize: 150},
                {num: 16, color: 'Black', game: 'Small Kite', prize: 150},
                {num: 17, color: 'Aqua', game: '$500 Coverall', prize: 500}
            ],
            '6-2': [
                {num: 1, color: 'Early Bird', game: 'Hard Way Bingo No Free Space', prize: 100},
                {num: 2, color: 'Early Bird', game: 'Diagonal and Outside Corners', prize: 100},
                {num: 3, color: 'Early Bird', game: 'Small Picture Frame', prize: 100},
                {num: 4, color: 'Blue', game: 'Block of 9', prize: 100},
                {num: 5, color: 'Orange', game: '$250 Number 7', prize: 250},
                {num: 6, color: 'Green', game: 'Small Diamond', prize: 100},
                {num: 7, color: 'Yellow', game: 'Razor Blade', prize: 100},
                {num: 8, color: 'Pink', game: '$250 Letter X', prize: 250},
                {num: 9, color: '', game: 'Event Game - Pot of Gold, etc.', prize: 0, special: true},
                {num: 10, color: 'Gray', game: '5 Around Any Corner', prize: 150},
                {num: 11, color: 'Olive', game: 'Double Postage Stamps', prize: 150},
                {num: 12, color: 'Brown', game: 'Outside Single Line', prize: 150},
                {num: 13, color: 'Progressive', game: 'Diamond', prize: 0, progressive: true},
                {num: 14, color: 'Red', game: 'Checkmark', prize: 150},
                {num: 15, color: 'Purple', game: 'Regular Bingo No Corners', prize: 150},
                {num: 16, color: 'Black', game: 'Any 3 on Top Row and 3 on Bottom Row', prize: 150},
                {num: 17, color: 'Aqua', game: '$500 Coverall', prize: 500}
            ],
            '7-3': [
                {num: 1, color: 'Early Bird', game: 'Hard Way Bingo No Free Space', prize: 100},
                {num: 2, color: 'Early Bird', game: 'Diagonal and Outside Corners', prize: 100},
                {num: 3, color: 'Early Bird', game: 'Small Picture Frame', prize: 100},
                {num: 4, color: 'Blue', game: '6 Pack Anywhere', prize: 100},
                {num: 5, color: 'Orange', game: '$250 Number 7', prize: 250},
                {num: 6, color: 'Green', game: 'Pyramid', prize: 100},
                {num: 7, color: 'Yellow', game: 'Champagne Glass', prize: 100},
                {num: 8, color: 'Pink', game: '$250 Letter X', prize: 250},
                {num: 9, color: '', game: 'Event Game - Pot of Gold, etc.', prize: 0, special: true},
                {num: 10, color: 'Gray', game: 'Bow Tie', prize: 150},
                {num: 11, color: 'Olive', game: 'Outside Line', prize: 150},
                {num: 12, color: 'Brown', game: 'L For Lions', prize: 150},
                {num: 13, color: 'Progressive', game: 'Diamond', prize: 0, progressive: true},
                {num: 14, color: 'Red', game: 'Checkmark', prize: 150},
                {num: 15, color: 'Purple', game: '5 Around Any Corner', prize: 150},
                {num: 16, color: 'Black', game: 'Small Kite', prize: 150},
                {num: 17, color: 'Aqua', game: '$500 Coverall', prize: 500}
            ],
            '8-4': [
                {num: 1, color: 'Early Bird', game: 'Hard Way Bingo No Free Space', prize: 100},
                {num: 2, color: 'Early Bird', game: 'Diagonal and Outside Corners', prize: 100},
                {num: 3, color: 'Early Bird', game: 'Small Picture Frame', prize: 100},
                {num: 4, color: 'Blue', game: 'Block of 9', prize: 100},
                {num: 5, color: 'Orange', game: '$250 Number 7', prize: 250},
                {num: 6, color: 'Green', game: 'Diamond', prize: 100},
                {num: 7, color: 'Yellow', game: 'Razor Blade', prize: 100},
                {num: 8, color: 'Pink', game: '$250 Letter X', prize: 250},
                {num: 9, color: '', game: 'Event Game - Pot of Gold, etc.', prize: 0, special: true},
                {num: 10, color: 'Gray', game: '5 Around Any Corner', prize: 150},
                {num: 11, color: 'Olive', game: 'Double Postage Stamp', prize: 150},
                {num: 12, color: 'Brown', game: 'Outside Single Line', prize: 150},
                {num: 13, color: 'Progressive', game: 'Diamond', prize: 0, progressive: true},
                {num: 14, color: 'Red', game: 'Checkmark', prize: 150},
                {num: 15, color: 'Purple', game: 'Regular Bingo', prize: 150},
                {num: 16, color: 'Black', game: 'Any 3 on Top Row and 3 on Bottom Row', prize: 150},
                {num: 17, color: 'Aqua', game: '$500 Coverall', prize: 500}
            ]
        };

        // Tab switching functionality
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Determine session based on date
        function determineSession() {
            const date = new Date(document.getElementById('occ-date').value);
            if (!date) return;

            const day = date.getDay();
            if (day !== 1) return; // Not a Monday

            const firstMonday = new Date(date.getFullYear(), date.getMonth(), 1);
            while (firstMonday.getDay() !== 1) {
                firstMonday.setDate(firstMonday.getDate() + 1);
            }

            const weekNumber = Math.ceil((date.getDate() - firstMonday.getDate() + 1) / 7) + 1;

            let session;
            switch(weekNumber) {
                case 1:
                case 5:
                    session = '5-1';
                    break;
                case 2:
                    session = '6-2';
                    break;
                case 3:
                    session = '7-3';
                    break;
                case 4:
                    session = '8-4';
                    break;
                default:
                    session = '5-1';
            }

            document.querySelector(`input[name="session"][value="${session}"]`).checked = true;
            loadSessionGames();
        }

        // Sync data between tabs
        function syncDate() {
            const date = document.getElementById('occ-date').value;
            document.getElementById('pt-date').value = date;
            document.getElementById('ms-date').value = date;
        }

        function syncLion() {
            const lion = document.getElementById('occ-lion').value;
            document.getElementById('ms-lion').value = lion;
        }

        // Birthday BOGO calculation
        function calculateBirthdayBOGO() {
            const birthdays = parseInt(document.getElementById('occ-birthdays').value) || 0;
            document.getElementById('eb-free').value = birthdays * 2; // 2 Early Birds per birthday
            document.getElementById('6f-free').value = birthdays * 1; // 1 Six Face per birthday
            document.getElementById('birthday-pack-net').value = birthdays; // Track in POS summary
            calculatePaperSales();
            calculateOccasionTotals();
        }

        // Calculate paper sales
        function calculatePaperSales() {
            const items = [
                { prefix: 'eb', hasFree: true },
                { prefix: '6f', hasFree: true },
                { prefix: '9fs', hasFree: false },
                { prefix: '9fst', hasFree: false },
                { prefix: 'p3', hasFree: false },
                { prefix: 'p18', hasFree: false }
            ];

            items.forEach(item => {
                const start = parseInt(document.getElementById(`${item.prefix}-start`).value) || 0;
                const end = parseInt(document.getElementById(`${item.prefix}-end`).value) || 0;
                const free = item.hasFree ? (parseInt(document.getElementById(`${item.prefix}-free`).value) || 0) : 0;
                const sold = start - end - free;
                document.getElementById(`${item.prefix}-sold`).textContent = sold;
            });
        }

        // Progressive prize calculation
        function calculateProgressivePrize() {
            const jackpot = parseFloat(document.getElementById('prog-jackpot').value) || 0;
            const ballsNeeded = parseInt(document.getElementById('prog-balls-needed').value) || 0;
            const actualBalls = parseInt(document.getElementById('prog-actual-balls').value) || 0;
            const consolation = parseFloat(document.getElementById('prog-consolation').value) || 0;

            let prize = 0;
            if (actualBalls > 0) {
                if (actualBalls <= ballsNeeded) {
                    prize = jackpot;
                } else {
                    prize = consolation;
                }
            }

            document.getElementById('prog-actual-prize').value = prize;
            calculateGameTotals();
        }

        // Load session games
        function loadSessionGames() {
            const sessionValue = document.querySelector('input[name="session"]:checked')?.value;
            if (!sessionValue) return;

            const tbody = document.getElementById('games-tbody');
            const title = document.getElementById('session-title');
            
            title.textContent = `Session ${sessionValue} - Rolla Lions Club Bingo`;
            tbody.innerHTML = '';

            const games = sessionsData[sessionValue];
            games.forEach(game => {
                if (game.special) {
                    // Skip event game - it's handled in pull-tabs
                    return;
                }

                const row = tbody.insertRow();
                if (game.progressive) {
                    row.className = 'progressive-row';
                    row.innerHTML = `
                        <td>${game.num}</td>
                        <td>${game.color}</td>
                        <td>${game.game}</td>
                        <td>$<span id="game-prog-prize">0</span></td>
                        <td><input type="number" class="winner-count" value="1" min="1" onchange="calculateGamePrize(this)"></td>
                        <td>$<input type="number" class="prize-per" id="prog-prize-per" value="0" readonly style="background: #f0f0f0;"></td>
                        <td class="game-total" id="prog-game-total" style="font-weight: bold;">$0.00</td>
                        <td><input type="checkbox" class="check-payment" id="prog-game-check" onchange="calculateGameTotals()"></td>
                    `;
                } else {
                    row.innerHTML = `
                        <td>${game.num}</td>
                        <td>${game.color}</td>
                        <td>${game.game}</td>
                        <td>$${game.prize}</td>
                        <td><input type="number" class="winner-count" value="1" min="1" onchange="calculateGamePrize(this)"></td>
                        <td>$<input type="number" class="prize-per" value="${game.prize}" onchange="calculateGameTotal(this)"></td>
                        <td class="game-total" style="font-weight: bold;">$${game.prize}.00</td>
                        <td><input type="checkbox" class="check-payment" onchange="calculateGameTotals()"></td>
                    `;
                }
            });

            calculateGameTotals();
        }

        // Calculate game prize for multiple winners
        function calculateGamePrize(input) {
            const row = input.closest('tr');
            const prizeCell = row.cells[3];
            const defaultPrize = parseFloat(prizeCell.textContent.replace('$', '')) || 0;
            const winners = parseInt(input.value) || 1;
            const prizePerWinner = Math.ceil(defaultPrize / winners);
            
            const prizePerInput = row.querySelector('.prize-per');
            if (!prizePerInput.readOnly) {
                prizePerInput.value = prizePerWinner;
                calculateGameTotal(prizePerInput);
            }
        }

        // Calculate game total
        function calculateGameTotal(input) {
            const row = input.closest('tr');
            const winners = parseInt(row.querySelector('.winner-count').value) || 1;
            const prizePerWinner = parseFloat(input.value) || 0;
            const total = winners * prizePerWinner;
            
            row.querySelector('.game-total').textContent = `$${total.toFixed(2)}`;
            calculateGameTotals();
        }

        // Calculate all game totals - FIXED to not duplicate progressive
        function calculateGameTotals() {
            let total = 0;
            let checkTotal = 0;

            // Get progressive prize value
            const progPrize = parseFloat(document.getElementById('prog-actual-prize').value) || 0;
            
            // Update progressive display in games table
            const progDisplay = document.getElementById('game-prog-prize');
            if (progDisplay) {
                progDisplay.textContent = progPrize;
                
                // Update progressive row values
                const progPrizePerInput = document.getElementById('prog-prize-per');
                const progGameTotal = document.getElementById('prog-game-total');
                if (progPrizePerInput && progGameTotal) {
                    progPrizePerInput.value = progPrize;
                    progGameTotal.textContent = `$${progPrize.toFixed(2)}`;
                }
            }

            // Calculate totals from all game rows
            document.querySelectorAll('#games-tbody tr').forEach(row => {
                const totalCell = row.querySelector('.game-total');
                const amount = parseFloat(totalCell.textContent.replace('$', '')) || 0;
                total += amount;

                if (row.querySelector('.check-payment').checked) {
                    checkTotal += amount;
                }
            });

            // Check if main progressive checkbox is checked
            if (document.getElementById('prog-check-payment').checked && progPrize > 0) {
                // Only add to check total if not already counted in games table
                const progGameCheck = document.getElementById('prog-game-check');
                if (!progGameCheck || !progGameCheck.checked) {
                    checkTotal += progPrize;
                }
            }

            document.getElementById('games-total').textContent = `$${total.toFixed(2)}`;
            document.getElementById('games-check-total').textContent = `$${checkTotal.toFixed(2)}`;
            
            bingoCheckPayments = checkTotal;
        }

        // Transfer bingo prizes to occasion report
        function transferBingoPrizes() {
            const total = document.getElementById('games-total').textContent;
            document.getElementById('occ-bingo-prizes').textContent = total;
            
            const checkTotal = document.getElementById('games-check-total').textContent;
            document.getElementById('occ-check-prizes').textContent = checkTotal;
            
            calculateOccasionTotals();
            alert('Bingo prizes transferred to Occasion Report!');
        }

        // Pull-Tab functions
        let gameCount = 0;
        
        function addPullTabGame() {
            gameCount++;
            const tbody = document.getElementById('pt-games-body');
            const row = tbody.insertRow(-1); // Insert before footer rows
            row.innerHTML = `
                <td><input type="text" placeholder="Game Name" style="width: 100%;"></td>
                <td><input type="text" placeholder="Serial #" style="width: 100%;"></td>
                <td>$<input type="number" value="1.00" step="0.01" style="width: 50px;" onchange="calculatePullTabRow(this)"></td>
                <td><input type="number" style="width: 60px;" onchange="calculatePullTabRow(this)"></td>
                <td class="sales" style="font-weight: bold;">$0.00</td>
                <td>$<input type="number" step="0.01" style="width: 80px;" onchange="calculatePullTabRow(this)"></td>
                <td>$<input type="number" step="0.01" style="width: 80px;" onchange="calculatePullTabRow(this)"></td>
                <td class="net" style="font-weight: bold;">$0.00</td>
                <td><input type="checkbox" class="pt-check-payment" onchange="calculatePullTabTotals()"></td>
            `;
        }

        function addSpecialEventGame() {
            const tbody = document.getElementById('pt-games-body');
            const row = tbody.insertRow(-1);
            row.className = 'special-event';
            row.innerHTML = `
                <td><input type="text" value="Special Event Game" style="width: 100%; font-weight: bold;"></td>
                <td><input type="text" placeholder="Serial #" style="width: 100%;"></td>
                <td>$<input type="number" value="1.00" step="0.01" style="width: 50px;" onchange="calculatePullTabRow(this)"></td>
                <td><input type="number" style="width: 60px;" onchange="calculatePullTabRow(this)"></td>
                <td class="sales" style="font-weight: bold;">$0.00</td>
                <td>$<input type="number" step="0.01" style="width: 80px;" onchange="calculatePullTabRow(this)"></td>
                <td>$<input type="number" step="0.01" style="width: 80px;" onchange="calculatePullTabRow(this)"></td>
                <td class="net" style="font-weight: bold;">$0.00</td>
                <td><input type="checkbox" class="pt-check-payment" onchange="calculatePullTabTotals()"></td>
            `;
        }

        function calculatePullTabRow(element) {
            const row = element.closest('tr');
            const inputs = row.querySelectorAll('input[type="number"]');
            const price = parseFloat(inputs[0].value) || 0;
            const tickets = parseFloat(inputs[1].value) || 0;
            const idealProfit = parseFloat(inputs[2].value) || 0;
            const prizesPaid = parseFloat(inputs[3].value) || 0;
            
            const sales = price * tickets;
            const net = sales - prizesPaid;
            
            row.querySelector('.sales').textContent = `$${sales.toFixed(2)}`;
            row.querySelector('.net').textContent = `$${net.toFixed(2)}`;
            
            calculatePullTabTotals();
        }

        function calculatePullTabTotals() {
            let regSales = 0, regIdeal = 0, regPrizes = 0, regNet = 0;
            let seSales = 0, seIdeal = 0, sePrizes = 0, seNet = 0;
            let checkTotal = 0;

            const tbody = document.getElementById('pt-games-body');
            const rows = tbody.querySelectorAll('tr');
            
            rows.forEach(row => {
                const salesText = row.querySelector('.sales').textContent;
                const sales = parseFloat(salesText.replace('$', '')) || 0;
                
                const inputs = row.querySelectorAll('input[type="number"]');
                const ideal = parseFloat(inputs[2].value) || 0;
                const prizes = parseFloat(inputs[3].value) || 0;
                
                const netText = row.querySelector('.net').textContent;
                const net = parseFloat(netText.replace('$', '')) || 0;

                if (row.querySelector('.pt-check-payment').checked) {
                    checkTotal += prizes;
                }

                if (row.classList.contains('special-event')) {
                    seSales += sales;
                    seIdeal += ideal;
                    sePrizes += prizes;
                    seNet += net;
                } else {
                    regSales += sales;
                    regIdeal += ideal;
                    regPrizes += prizes;
                    regNet += net;
                }
            });

            // Update regular totals
            document.getElementById('pt-reg-sales').textContent = `$${regSales.toFixed(2)}`;
            document.getElementById('pt-reg-ideal').textContent = `$${regIdeal.toFixed(2)}`;
            document.getElementById('pt-reg-prizes').textContent = `$${regPrizes.toFixed(2)}`;
            document.getElementById('pt-reg-net').textContent = `$${regNet.toFixed(2)}`;

            // Update special event totals
            document.getElementById('pt-se-sales').textContent = `$${seSales.toFixed(2)}`;
            document.getElementById('pt-se-ideal').textContent = `$${seIdeal.toFixed(2)}`;
            document.getElementById('pt-se-prizes').textContent = `$${sePrizes.toFixed(2)}`;
            document.getElementById('pt-se-net').textContent = `$${seNet.toFixed(2)}`;

            // Update grand totals
            document.getElementById('pt-total-sales').textContent = `$${(regSales + seSales).toFixed(2)}`;
            document.getElementById('pt-total-ideal').textContent = `$${(regIdeal + seIdeal).toFixed(2)}`;
            document.getElementById('pt-total-prizes').textContent = `$${(regPrizes + sePrizes).toFixed(2)}`;
            document.getElementById('pt-total-net').textContent = `$${(regNet + seNet).toFixed(2)}`;

            // Store for transfer
            pullTabData = {
                regularSales: regSales,
                regularPrizes: regPrizes,
                specialSales: seSales,
                specialPrizes: sePrizes,
                checkPayments: checkTotal
            };

            // Update expected
            document.getElementById('pt-expected').textContent = `$${(regNet + seNet).toFixed(2)}`;
            calculatePullTabCash();
        }

        function clearPullTabGames() {
            if (confirm('Clear all games?')) {
                document.getElementById('pt-games-body').innerHTML = '';
                calculatePullTabTotals();
            }
        }

        function calculatePullTabCash() {
            const amounts = [
                { id: 'pt-hundreds', value: 1 },
                { id: 'pt-fifties', value: 1 },
                { id: 'pt-twenties', value: 1 },
                { id: 'pt-tens', value: 1 },
                { id: 'pt-fives', value: 1 },
                { id: 'pt-ones', value: 1 },
                { id: 'pt-coins', value: 1 }
            ];
            
            let total = 0;
            amounts.forEach(item => {
                const amount = parseFloat(document.getElementById(item.id).value) || 0;
                total += amount;
            });
            
            document.getElementById('pt-deposit-total').textContent = `$${total.toFixed(2)}`;
            document.getElementById('pt-turnin').textContent = `$${total.toFixed(2)}`;
            
            const netTotal = total - 550;
            document.getElementById('pt-net-total').textContent = `$${netTotal.toFixed(2)}`;
            
            // Calculate over/short
            const expectedNet = parseFloat(document.getElementById('pt-expected').textContent.replace('$', '')) || 0;
            const overshort = netTotal - expectedNet;
            
            const overshortElement = document.getElementById('pt-overshort');
            overshortElement.textContent = `$${Math.abs(overshort).toFixed(2)}`;
            overshortElement.className = overshort >= 0 ? 'status-good' : 'status-bad';
            if (overshort < 0) {
                overshortElement.textContent = `($${Math.abs(overshort).toFixed(2)})`;
            }
        }

        function transferPullTabTotals() {
            document.getElementById('occ-pulltab-sales').textContent = `$${pullTabData.regularSales.toFixed(2)}`;
            document.getElementById('occ-event-game').textContent = `$${pullTabData.specialSales.toFixed(2)}`;
            document.getElementById('occ-pulltab-prizes').textContent = `$${pullTabData.regularPrizes.toFixed(2)}`;
            document.getElementById('occ-event-prizes').textContent = `$${pullTabData.specialPrizes.toFixed(2)}`;
            
            // Add to check payments if any
            const currentCheckPayments = parseFloat(document.getElementById('occ-check-prizes').textContent.replace('$', '')) || 0;
            document.getElementById('occ-check-prizes').textContent = `$${(currentCheckPayments + pullTabData.checkPayments).toFixed(2)}`;
            
            calculateOccasionTotals();
            alert('Pull-Tab totals transferred to Occasion Report!');
        }

        // Occasion Report calculations - FIXED startup cash calculation
        function calculateOccasionTotals() {
            const posItems = [
                { id: 'ebd', price: 5 },
                { id: '6face', price: 10 },
                { id: '9solid', price: 15 },
                { id: '9stripe', price: 10 },
                { id: 'birthday-pack', price: 0 }, // Birthday packs are free
                { id: 'prog18', price: 5 },
                { id: 'prog3', price: 1 },
                { id: 'letterx', price: 1 },
                { id: 'number7', price: 1 },
                { id: 'coverall', price: 1 }
            ];
            
            let totalPaperSales = 0;
            posItems.forEach(item => {
                const qty = parseFloat(document.getElementById(`${item.id}-net`).value) || 0;
                const sales = qty * item.price;
                document.getElementById(`${item.id}-sales`).textContent = `$${sales.toFixed(2)}`;
                totalPaperSales += sales;
            });
            
            document.getElementById('total-paper-sales').textContent = `$${totalPaperSales.toFixed(2)}`;
            
            // Calculate electronic sales
            const smallMachines = parseFloat(document.getElementById('small-machines').value) || 0;
            const largeMachines = parseFloat(document.getElementById('large-machines').value) || 0;
            const smallTotal = smallMachines * 40;
            const largeTotal = largeMachines * 65;
            const totalElectronic = smallTotal + largeTotal;
            
            document.getElementById('small-machines-total').textContent = `$${smallTotal.toFixed(2)}`;
            document.getElementById('large-machines-total').textContent = `$${largeTotal.toFixed(2)}`;
            document.getElementById('total-electronic-sales').textContent = `$${totalElectronic.toFixed(2)}`;
            
            // Calculate miscellaneous
            const daubers = parseFloat(document.getElementById('daubers').value) || 0;
            const dauberTotal = daubers * 2;
            document.getElementById('daubers-total').textContent = `$${dauberTotal.toFixed(2)}`;
            document.getElementById('total-misc').textContent = `$${dauberTotal.toFixed(2)}`;
            
            // Calculate totals
            const totalBingo = totalPaperSales + totalElectronic + dauberTotal;
            document.getElementById('occ-total-bingo').textContent = `$${totalBingo.toFixed(2)}`;
            
            const pulltabSales = parseFloat(document.getElementById('occ-pulltab-sales').textContent.replace('$', '')) || 0;
            const eventGame = parseFloat(document.getElementById('occ-event-game').textContent.replace('$', '')) || 0;
            const grossSales = totalBingo + pulltabSales + eventGame;
            document.getElementById('occ-gross-sales').textContent = `$${grossSales.toFixed(2)}`;
            
            const bingoPrizes = parseFloat(document.getElementById('occ-bingo-prizes').textContent.replace('$', '')) || 0;
            const pulltabPrizes = parseFloat(document.getElementById('occ-pulltab-prizes').textContent.replace('$', '')) || 0;
            const eventPrizes = parseFloat(document.getElementById('occ-event-prizes').textContent.replace('$', '')) || 0;
            const totalPrizes = bingoPrizes + pulltabPrizes + eventPrizes;
            document.getElementById('occ-total-prizes').textContent = `$${totalPrizes.toFixed(2)}`;
            
            // Get deposit from Money Summary if available
            const deposit = parseFloat(document.getElementById('occ-cash-deposit').textContent.replace('$', '')) || 0;
            
            // Calculate net deposit (Total Cash Deposit - Startup Cash)
            const netDeposit = deposit - 1000;
            document.getElementById('occ-net-deposit').textContent = `$${netDeposit.toFixed(2)}`;
            
            // Calculate ideal profit (Gross Sales - Total Prizes)
            const idealProfit = grossSales - totalPrizes;
            document.getElementById('occ-expected').textContent = `$${idealProfit.toFixed(2)}`;
            
            // Calculate over/short (Actual Profit - Ideal Profit)
            if (deposit > 0) {
                const actualProfit = netDeposit; // Deposit minus startup
                const overshort = actualProfit - idealProfit;
                const overshortElement = document.getElementById('occ-overshort');
                overshortElement.textContent = `$${Math.abs(overshort).toFixed(2)}`;
                overshortElement.className = overshort >= 0 ? 'status-good' : 'status-bad';
                if (overshort < 0) {
                    overshortElement.textContent = `($${Math.abs(overshort).toFixed(2)})`;
                }
            }

            // Update metrics
            calculateMetrics();
        }

        // Calculate performance metrics
        function calculateMetrics() {
            const players = parseInt(document.getElementById('occ-people').value) || 0;
            const grossSales = parseFloat(document.getElementById('occ-gross-sales').textContent.replace('$', '')) || 0;
            const totalPrizes = parseFloat(document.getElementById('occ-total-prizes').textContent.replace('$', '')) || 0;
            const netProfit = grossSales - totalPrizes; // Ideal profit
            
            document.getElementById('metric-players').textContent = players;
            document.getElementById('metric-gross').textContent = `$${grossSales.toFixed(2)}`;
            document.getElementById('metric-profit').textContent = `$${netProfit.toFixed(2)}`;
            
            const profitPerPlayer = players > 0 ? netProfit / players : 0;
            document.getElementById('metric-per-player').textContent = `$${profitPerPlayer.toFixed(2)}`;
        }

        // Copy metrics to clipboard - UPDATED FORMAT
        function copyMetricsToClipboard() {
            const players = document.getElementById('metric-players').textContent;
            const date = document.getElementById('occ-date').value;
            const session = document.querySelector('input[name="session"]:checked')?.value || '';
            const ptLion = document.getElementById('pt-lion').value || '[Not entered]';
            const occLion = document.getElementById('occ-lion').value || '[Not entered]';
            
            // Get bingo values
            const bingoSales = document.getElementById('occ-total-bingo').textContent;
            const bingoPrizes = document.getElementById('occ-bingo-prizes').textContent;
            const bingoProfit = parseFloat(bingoSales.replace('$', '')) - parseFloat(bingoPrizes.replace('$', ''));
            
            // Get pull-tab values
            const ptRegularSales = document.getElementById('occ-pulltab-sales').textContent;
            const ptSpecialSales = document.getElementById('occ-event-game').textContent;
            const ptTotalSales = parseFloat(ptRegularSales.replace('$', '')) + parseFloat(ptSpecialSales.replace('$', ''));
            const ptRegularPrizes = document.getElementById('occ-pulltab-prizes').textContent;
            const ptSpecialPrizes = document.getElementById('occ-event-prizes').textContent;
            const ptTotalPrizes = parseFloat(ptRegularPrizes.replace('$', '')) + parseFloat(ptSpecialPrizes.replace('$', ''));
            const ptNetProfit = ptTotalSales - ptTotalPrizes;
            
            // Get totals
            const grossSales = document.getElementById('occ-gross-sales').textContent;
            const totalPrizes = document.getElementById('occ-total-prizes').textContent;
            const totalNetProfit = document.getElementById('metric-profit').textContent;
            const profitPerPlayer = document.getElementById('metric-per-player').textContent;
            
            const text = `Bingo Session Results
Session ${session}: ${date}
Total Players: ${players}
-----------------
Lion in Charge of Pull-Tabs: ${ptLion}
Pull-Tab Sales: $${ptTotalSales.toFixed(2)}
Pull-Tab Prizes Paid: $${ptTotalPrizes.toFixed(2)}
Pull-Tab Net Profit: $${ptNetProfit.toFixed(2)}
-----------------
Lion in Charge of Bingo Closet: ${occLion}
Bingo Sales: ${bingoSales}
Bingo Prizes Paid: ${bingoPrizes}
Bingo Net Profit: $${bingoProfit.toFixed(2)}
-----------------
Gross Sales: ${grossSales}
Total Prizes Paid: ${totalPrizes}
Total Net Profit: ${totalNetProfit}
Profit per Player: ${profitPerPlayer}
-----------------
Thank you to all volunteers!`;
            
            navigator.clipboard.writeText(text).then(() => {
                alert('Metrics copied to clipboard! You can now paste into an email.');
            });
        }

        // Money Summary functions
        function calculateMoneyTotals() {
            const denominations = [
                { base: '100', label: 'hundred' },
                { base: '50', label: 'fifty' },
                { base: '20', label: 'twenty' },
                { base: '10', label: 'ten' },
                { base: '5', label: 'five' },
                { base: '2', label: 'two' },
                { base: '1', label: 'one' },
                { base: 'coins', label: 'coins' }
            ];
            
            let bingoTotal = 0;
            let pulltabTotal = 0;
            let grandCurrency = 0;
            let grandCoin = 0;
            
            denominations.forEach(denom => {
                const bingoAmount = parseFloat(document.getElementById(`bingo-${denom.base}`).value) || 0;
                const pulltabAmount = parseFloat(document.getElementById(`pulltab-${denom.base}`).value) || 0;
                
                bingoTotal += bingoAmount;
                pulltabTotal += pulltabAmount;
                
                const totalAmount = bingoAmount + pulltabAmount;
                document.getElementById(`total-${denom.base}`).textContent = `$${totalAmount.toFixed(2)}`;
                
                if (denom.base === 'coins') {
                    grandCoin += totalAmount;
                } else {
                    grandCurrency += totalAmount;
                }
            });
            
            // Handle checks
            const bingoChecks = parseFloat(document.getElementById('bingo-checks').value) || 0;
            bingoTotal += bingoChecks;
            document.getElementById('total-checks').textContent = `$${bingoChecks.toFixed(2)}`;
            
            // Update subtotals and totals
            document.getElementById('bingo-subtotal').textContent = `$${(bingoTotal - bingoChecks).toFixed(2)}`;
            document.getElementById('bingo-total').textContent = `$${bingoTotal.toFixed(2)}`;
            
            document.getElementById('pulltab-subtotal').textContent = `$${pulltabTotal.toFixed(2)}`;
            document.getElementById('pulltab-total').textContent = `$${pulltabTotal.toFixed(2)}`;
            
            const grandTotal = bingoTotal + pulltabTotal;
            document.getElementById('grand-subtotal').textContent = `$${(grandTotal - bingoChecks).toFixed(2)}`;
            document.getElementById('grand-total').textContent = `$${grandTotal.toFixed(2)}`;
            
            // Update deposit summary
            document.getElementById('deposit-currency').textContent = `$${grandCurrency.toFixed(2)}`;
            document.getElementById('deposit-coin').textContent = `$${grandCoin.toFixed(2)}`;
            document.getElementById('deposit-checks').textContent = `$${bingoChecks.toFixed(2)}`;
            document.getElementById('deposit-total').textContent = `$${grandTotal.toFixed(2)}`;
        }

        function transferToOccasion() {
            const total = document.getElementById('deposit-total').textContent;
            document.getElementById('occ-cash-deposit').textContent = total;
            calculateOccasionTotals();
            alert('Cash deposit transferred to Occasion Report!');
        }

        // Clear all data
        function clearAllData() {
            if (!confirm('This will clear ALL data from all forms. Are you sure?')) {
                return;
            }
            
            // Clear all inputs
            document.querySelectorAll('input[type="number"], input[type="text"], input[type="date"]').forEach(input => {
                if (!input.readOnly) {
                    input.value = '';
                }
            });
            
            // Uncheck all checkboxes
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            
            // Clear calculated fields
            document.querySelectorAll('td[id*="-sold"], td[id*="-sales"], td[id*="-total"]').forEach(td => {
                td.textContent = td.textContent.includes('$') ? '$0.00' : '0';
            });
            
            // Reset pull-tab games
            document.getElementById('pt-games-body').innerHTML = '';
            
            // Reload session games
            loadSessionGames();
            
            // Recalculate everything
            calculateOccasionTotals();
            calculateGameTotals();
            calculatePullTabTotals();
            calculateMoneyTotals();
        }

        // Print functionality
        function printAllForms(type) {
            // Make all tabs visible for printing
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => {
                tab.style.display = 'block';
            });

            if (type === 'blank') {
                document.body.classList.add('blank-form');
                const values = storeAllValues();
                clearForBlankPrint();
                window.print();
                restoreAllValues(values);
                document.body.classList.remove('blank-form');
            } else {
                window.print();
            }

            // Restore normal tab display
            tabs.forEach(tab => {
                tab.style.display = '';
            });
            document.querySelector('.tab-content.active').style.display = 'block';
        }

        function printCurrentTab(type) {
            if (type === 'blank') {
                document.body.classList.add('blank-form');
                const values = storeAllValues();
                clearForBlankPrint();
                window.print();
                restoreAllValues(values);
                document.body.classList.remove('blank-form');
            } else {
                window.print();
            }
        }

        function storeAllValues() {
            const values = {
                inputs: [],
                checkboxes: [],
                radios: [],
                textContent: []
            };
            
            // Store input values
            document.querySelectorAll('input[type="number"], input[type="text"], input[type="date"]').forEach(input => {
                values.inputs.push({
                    id: input.id || input.name,
                    value: input.value
                });
            });
            
            // Store checkbox states
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                values.checkboxes.push({
                    id: cb.id || cb.className,
                    checked: cb.checked
                });
            });
            
            // Store radio states
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                values.radios.push({
                    name: radio.name,
                    value: radio.value,
                    checked: radio.checked
                });
            });
            
            // Store calculated text content
            document.querySelectorAll('td[id], span[id]').forEach(elem => {
                if (elem.id && elem.textContent) {
                    values.textContent.push({
                        id: elem.id,
                        content: elem.textContent
                    });
                }
            });
            
            return values;
        }

        function clearForBlankPrint() {
            // Clear all inputs except readonly
            document.querySelectorAll('input[type="number"], input[type="text"]').forEach(input => {
                if (!input.readOnly) {
                    input.value = '';
                }
            });
            
            // Keep dates but clear if needed
            document.querySelectorAll('input[type="date"]').forEach(input => {
                // Optionally keep date for reference
            });
            
            // Uncheck all checkboxes
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                cb.checked = false;
            });
            
            // Clear calculated fields
            document.querySelectorAll('td[id*="-sold"]').forEach(td => {
                td.textContent = '';
            });
            
            document.querySelectorAll('td[id*="-sales"], td[id*="-total"], td[id*="occ-"], td[id*="pt-"], td[id*="games-"], td[id*="grand-"], td[id*="deposit-"], td[id*="total-"]').forEach(td => {
                if (td.textContent.includes('$')) {
                    td.textContent = '$____';
                } else {
                    td.textContent = '____';
                }
            });
        }

        function restoreAllValues(values) {
            // Restore input values
            values.inputs.forEach(item => {
                const elem = item.id ? document.getElementById(item.id) : document.querySelector(`input[name="${item.id}"]`);
                if (elem) elem.value = item.value;
            });
            
            // Restore checkbox states
            values.checkboxes.forEach(item => {
                const elem = item.id ? document.getElementById(item.id) : document.querySelector(`.${item.id}`);
                if (elem) elem.checked = item.checked;
            });
            
            // Restore radio states
            values.radios.forEach(item => {
                const elem = document.querySelector(`input[name="${item.name}"][value="${item.value}"]`);
                if (elem) elem.checked = item.checked;
            });
            
            // Restore text content
            values.textContent.forEach(item => {
                const elem = document.getElementById(item.id);
                if (elem) elem.textContent = item.content;
            });
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('occ-date').value = today;
            document.getElementById('pt-date').value = today;
            document.getElementById('ms-date').value = today;
            
            // Determine and set session
            determineSession();
            
            // Load initial session games
            loadSessionGames();
            
            // Add initial pull-tab games
            for (let i = 0; i < 8; i++) {
                addPullTabGame();
            }
            
            // Initialize calculations
            calculateOccasionTotals();
            calculateGameTotals();
            calculatePullTabTotals();
            calculateMoneyTotals();
        });
        // ==========================================
        // RLC BINGO INTEGRATION SCRIPT
        // Version 9.0 - Complete Backend Integration
        // ==========================================
        
        // Configuration
        const RLC_CONFIG = {
            // Replace with your deployed Web App URL
            API_URL: 'https://script.google.com/macros/s/AKfycbyYhF94GgZeBjhRgh6D-eS6DTTXXgexiR_sz1UbwpZEZ8fZX1z2bTY14X6F0hEsqN6ZZw/exec',
            
            // Storage keys
            STORAGE_KEYS: {
                CURRENT_OCCASION: 'rlc_current_occasion',
                OFFLINE_QUEUE: 'rlc_offline_queue',
                LAST_SYNC: 'rlc_last_sync',
                PULL_TAB_LIBRARY: 'rlc_pulltab_library'
            },
            
            // Auto-save interval (milliseconds)
            AUTO_SAVE_INTERVAL: 30000, // 30 seconds
            
            // Offline sync retry interval
            SYNC_RETRY_INTERVAL: 60000 // 1 minute
        };
        
        // ==========================================
        // INITIALIZATION
        // ==========================================
        
        class RLCBingoIntegration {
            constructor() {
                this.isOnline = navigator.onLine;
                this.currentOccasion = null;
                this.autoSaveTimer = null;
                this.syncTimer = null;
                this.pullTabLibrary = [];
                
                this.init();
            }
            
            init() {
                // Load saved data from localStorage
                this.loadSavedData();
                
                // Setup event listeners
                this.setupEventListeners();
                
                // Load pull-tab library
                this.loadPullTabLibrary();
                
                // Start auto-save
                this.startAutoSave();
                
                // Check online status
                this.checkOnlineStatus();
                
                // Attempt to sync offline data
                if (this.isOnline) {
                    this.syncOfflineData();
                }
                
                console.log('RLC Bingo Integration initialized');
            }
            
            // ==========================================
            // EVENT LISTENERS
            // ==========================================
            
            setupEventListeners() {
                // Online/Offline status
                window.addEventListener('online', () => this.handleOnline());
                window.addEventListener('offline', () => this.handleOffline());
                
                // Form submission
                const saveButton = document.getElementById('save-occasion');
                if (saveButton) {
                    saveButton.addEventListener('click', () => this.saveOccasion());
                }
                
                // Load occasion
                const loadButton = document.getElementById('load-occasion');
                if (loadButton) {
                    loadButton.addEventListener('click', () => this.showLoadDialog());
                }
                
                // Tab changes
                document.querySelectorAll('.tab-button').forEach(button => {
                    button.addEventListener('click', () => this.saveCurrentTab());
                });
                
                // Form field changes for auto-save
                document.querySelectorAll('input, select, textarea').forEach(field => {
                    field.addEventListener('change', () => this.markDirty());
                });
                
                // Pull-tab game selection
                const pullTabSelect = document.getElementById('pulltab-game-select');
                if (pullTabSelect) {
                    pullTabSelect.addEventListener('change', (e) => this.loadPullTabGameDetails(e.target.value));
                }
                
                // Progressive game calculations
                const progBalls = document.getElementById('prog-actual-balls');
                if (progBalls) {
                    progBalls.addEventListener('change', () => this.calculateProgressivePrize());
                }
            }
            
            // ==========================================
            // DATA COLLECTION
            // ==========================================
            
            collectFormData() {
                const data = {
                    // Occasion data
                    date: document.getElementById('occ-date')?.value,
                    sessionType: document.querySelector('input[name="session"]:checked')?.value,
                    lionInCharge: document.getElementById('occ-lion')?.value,
                    totalPeople: parseInt(document.getElementById('occ-people')?.value) || 0,
                    birthdays: parseInt(document.getElementById('occ-birthdays')?.value) || 0,
                    
                    // Progressive game
                    progressive: {
                        jackpot: parseFloat(document.getElementById('prog-jackpot')?.value) || 0,
                        ballsNeeded: parseInt(document.getElementById('prog-balls-needed')?.value) || 48,
                        consolation: parseFloat(document.getElementById('prog-consolation')?.value) || 200,
                        actualBalls: parseInt(document.getElementById('prog-actual-balls')?.value) || 0,
                        prizeAwarded: parseFloat(document.getElementById('prog-prize')?.value) || 0,
                        checkPayment: document.getElementById('prog-check-payment')?.checked || false
                    },
                    
                    // Paper Bingo Sales
                    paperBingo: this.collectPaperBingoData(),
                    
                    // POS Door Sales
                    posDoorSales: this.collectPOSDoorSalesData(),
                    
                    // Electronic Bingo
                    electronicBingo: this.collectElectronicBingoData(),
                    
                    // Session Games
                    sessionGames: this.collectSessionGamesData(),
                    
                    // Pull-Tab Games
                    pullTabGames: this.collectPullTabGamesData(),
                    
                    // Money Count
                    moneyCount: this.collectMoneyCountData(),
                    
                    // Metadata
                    metadata: {
                        createdAt: new Date().toISOString(),
                        deviceId: this.getDeviceId(),
                        version: '9.0'
                    }
                };
                
                return data;
            }
            
            collectPaperBingoData() {
                const types = ['special3on', 'special6on', 'special9on', 'regular3on', 'regular6on', 'regular9on'];
                const data = {};
                
                types.forEach(type => {
                    data[type] = {
                        start: parseInt(document.getElementById(`paper-${type}-start`)?.value) || 0,
                        free: parseInt(document.getElementById(`paper-${type}-free`)?.value) || 0,
                        end: parseInt(document.getElementById(`paper-${type}-end`)?.value) || 0
                    };
                });
                
                return data;
            }
            
            collectPOSDoorSalesData() {
                const items = ['special3on', 'special6on', 'special9on', 'special9onActual', 
                               'regular3on', 'regular6on', 'regular9on', 'regular2nd9on', 
                               'daubers', 'dobber'];
                const data = {};
                
                items.forEach(item => {
                    data[item] = parseInt(document.getElementById(`pos-${item}`)?.value) || 0;
                });
                
                return data;
            }
            
            collectElectronicBingoData() {
                return {
                    smallMachines: parseInt(document.getElementById('electronic-small')?.value) || 0,
                    largeMachines: parseInt(document.getElementById('electronic-large')?.value) || 0
                };
            }
            
            collectSessionGamesData() {
                const games = [];
                const rows = document.querySelectorAll('#games-tbody tr');
                
                rows.forEach((row, index) => {
                    const cells = row.querySelectorAll('td');
                    const winnerInput = row.querySelector('.winner-count');
                    const prizeInput = row.querySelector('.prize-per');
                    const checkInput = row.querySelector('.check-payment');
                    
                    games.push({
                        number: index + 1,
                        color: cells[1]?.textContent || '',
                        name: cells[2]?.textContent || '',
                        prize: parseFloat(cells[3]?.textContent.replace('$', '')) || 0,
                        winners: parseInt(winnerInput?.value) || 0,
                        prizePerWinner: parseFloat(prizeInput?.value) || 0,
                        totalPayout: parseFloat(cells[6]?.textContent.replace('$', '')) || 0,
                        checkPayment: checkInput?.checked || false
                    });
                });
                
                return games;
            }
            
            collectPullTabGamesData() {
                const games = [];
                const rows = document.querySelectorAll('#pt-games-body tr');
                
                rows.forEach(row => {
                    const cells = row.querySelectorAll('td');
                    const inputs = row.querySelectorAll('input');
                    
                    if (cells.length > 0) {
                        games.push({
                            gameName: cells[0]?.textContent || '',
                            serialNumber: cells[1]?.textContent || '',
                            pricePerTicket: parseFloat(cells[2]?.textContent.replace('$', '')) || 1,
                            ticketsSold: parseInt(inputs[0]?.value) || 0,
                            salesRevenue: parseFloat(cells[4]?.textContent.replace('$', '')) || 0,
                            idealProfit: parseFloat(cells[5]?.textContent.replace('$', '')) || 0,
                            prizesPaid: parseFloat(inputs[1]?.value) || 0,
                            netProfit: parseFloat(cells[7]?.textContent.replace('$', '')) || 0,
                            specialEvent: row.classList.contains('special-event'),
                            checkPayment: inputs[2]?.checked || false
                        });
                    }
                });
                
                return games;
            }
            
            collectMoneyCountData() {
                return {
                    hundreds: parseInt(document.getElementById('money-hundreds')?.value) || 0,
                    fifties: parseInt(document.getElementById('money-fifties')?.value) || 0,
                    twenties: parseInt(document.getElementById('money-twenties')?.value) || 0,
                    tens: parseInt(document.getElementById('money-tens')?.value) || 0,
                    fives: parseInt(document.getElementById('money-fives')?.value) || 0,
                    ones: parseInt(document.getElementById('money-ones')?.value) || 0,
                    quarters: parseInt(document.getElementById('money-quarters')?.value) || 0,
                    dimes: parseInt(document.getElementById('money-dimes')?.value) || 0,
                    nickels: parseInt(document.getElementById('money-nickels')?.value) || 0,
                    pennies: parseInt(document.getElementById('money-pennies')?.value) || 0,
                    checksTotal: parseFloat(document.getElementById('money-checks-total')?.value) || 0,
                    startingBank: parseFloat(document.getElementById('money-starting-bank')?.value) || 500,
                    expectedRevenue: parseFloat(document.getElementById('money-expected')?.value) || 0,
                    depositAmount: parseFloat(document.getElementById('money-deposit')?.value) || 0
                };
            }
            
            // ==========================================
            // SAVE OPERATIONS
            // ==========================================
            
            async saveOccasion() {
                const data = this.collectFormData();
                
                // Validate required fields
                if (!this.validateFormData(data)) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                // Show loading indicator
                this.showLoading('Saving occasion...');
                
                try {
                    if (this.isOnline) {
                        // Save online
                        const result = await this.saveToBackend(data);
                        if (result.success) {
                            this.currentOccasion = result.occasionId;
                            this.showSuccess('Occasion saved successfully!');
                            this.clearLocalStorage();
                        } else {
                            throw new Error(result.error || 'Save failed');
                        }
                    } else {
                        // Save offline
                        this.saveToOfflineQueue(data);
                        this.showWarning('Saved offline. Will sync when connection restored.');
                    }
                } catch (error) {
                    console.error('Save error:', error);
                    this.showError('Error saving occasion: ' + error.message);
                    // Save to offline queue as fallback
                    this.saveToOfflineQueue(data);
                } finally {
                    this.hideLoading();
                }
            }
            
            async saveToBackend(data) {
                const response = await fetch(RLC_CONFIG.API_URL + '?path=save-occasion', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                
                return await response.json();
            }
            
            saveToOfflineQueue(data) {
                const queue = this.getOfflineQueue();
                queue.push({
                    id: 'OFFLINE_' + Date.now(),
                    data: data,
                    timestamp: new Date().toISOString()
                });
                localStorage.setItem(RLC_CONFIG.STORAGE_KEYS.OFFLINE_QUEUE, JSON.stringify(queue));
            }
            
            // ==========================================
            // LOAD OPERATIONS
            // ==========================================
            
            async loadOccasion(occasionId) {
                this.showLoading('Loading occasion...');
                
                try {
                    const response = await fetch(RLC_CONFIG.API_URL + '?path=occasion&id=' + occasionId);
                    const result = await response.json();
                    
                    if (result.success) {
                        this.populateFormData(result.occasion);
                        this.currentOccasion = occasionId;
                        this.showSuccess('Occasion loaded successfully!');
                    } else {
                        throw new Error(result.error || 'Load failed');
                    }
                } catch (error) {
                    console.error('Load error:', error);
                    this.showError('Error loading occasion: ' + error.message);
                } finally {
                    this.hideLoading();
                }
            }
            
            populateFormData(occasion) {
                // Populate occasion fields
                document.getElementById('occ-date').value = occasion.date || '';
                document.getElementById('occ-lion').value = occasion.lionInCharge || '';
                document.getElementById('occ-people').value = occasion.totalPeople || '';
                document.getElementById('occ-birthdays').value = occasion.birthdays || '';
                
                // Set session type
                const sessionRadio = document.querySelector(`input[name="session"][value="${occasion.sessionType}"]`);
                if (sessionRadio) {
                    sessionRadio.checked = true;
                    loadSessionGames(); // Trigger games load
                }
                
                // Populate progressive
                document.getElementById('prog-jackpot').value = occasion.progressive?.jackpot || '';
                document.getElementById('prog-balls-needed').value = occasion.progressive?.ballsNeeded || 48;
                document.getElementById('prog-consolation').value = occasion.progressive?.consolation || 200;
                document.getElementById('prog-actual-balls').value = occasion.progressive?.actualBalls || '';
                document.getElementById('prog-prize').value = occasion.progressive?.prizeAwarded || '';
                document.getElementById('prog-check-payment').checked = occasion.progressive?.checkPayment || false;
                
                // Populate other sections as needed
                if (occasion.paperBingo) {
                    this.populatePaperBingo(occasion.paperBingo);
                }
                
                if (occasion.posDoorSales) {
                    this.populatePOSDoorSales(occasion.posDoorSales);
                }
                
                if (occasion.sessionGames) {
                    this.populateSessionGames(occasion.sessionGames);
                }
                
                if (occasion.pullTabGames) {
                    this.populatePullTabGames(occasion.pullTabGames);
                }
                
                if (occasion.moneyCount) {
                    this.populateMoneyCount(occasion.moneyCount);
                }
                
                // Recalculate all totals
                this.recalculateAllTotals();
            }
            
            // ==========================================
            // PULL-TAB LIBRARY
            // ==========================================
            
            async loadPullTabLibrary() {
                try {
                    // Check local storage first
                    const cached = localStorage.getItem(RLC_CONFIG.STORAGE_KEYS.PULL_TAB_LIBRARY);
                    if (cached) {
                        this.pullTabLibrary = JSON.parse(cached);
                        this.populatePullTabSelect();
                    }
                    
                    // Load fresh data if online
                    if (this.isOnline) {
                        const response = await fetch(RLC_CONFIG.API_URL + '?path=pulltab-library');
                        const result = await response.json();
                        
                        if (result.success) {
                            this.pullTabLibrary = result.games;
                            localStorage.setItem(RLC_CONFIG.STORAGE_KEYS.PULL_TAB_LIBRARY, JSON.stringify(result.games));
                            this.populatePullTabSelect();
                        }
                    }
                } catch (error) {
                    console.error('Error loading pull-tab library:', error);
                }
            }
            
            populatePullTabSelect() {
                const select = document.getElementById('pulltab-game-select');
                if (!select) return;
                
                select.innerHTML = '<option value="">Select a game...</option>';
                
                this.pullTabLibrary.forEach(game => {
                    const option = document.createElement('option');
                    option.value = game['Form Number'];
                    option.textContent = `${game['Display Name']} (${game['Form Number']})`;
                    select.appendChild(option);
                });
            }
            
            loadPullTabGameDetails(formNumber) {
                const game = this.pullTabLibrary.find(g => g['Form Number'] === formNumber);
                if (!game) return;
                
                // Populate game details
                document.getElementById('pt-game-name').value = game['Game Name'];
                document.getElementById('pt-top-prize').value = game['Top Prize'];
                document.getElementById('pt-ticket-count').value = game['Ticket Count'];
                document.getElementById('pt-price-per').value = game['Price Per Ticket'];
                document.getElementById('pt-ideal-profit').value = game['Ideal Profit'];
                document.getElementById('pt-payout-percent').value = game['Payout Percentage'];
            }
            
            // ==========================================
            // OFFLINE SYNC
            // ==========================================
            
            async syncOfflineData() {
                const queue = this.getOfflineQueue();
                if (queue.length === 0) return;
                
                console.log(`Syncing ${queue.length} offline occasions...`);
                
                const successful = [];
                const failed = [];
                
                for (const item of queue) {
                    try {
                        const result = await this.saveToBackend(item.data);
                        if (result.success) {
                            successful.push(item.id);
                        } else {
                            failed.push(item.id);
                        }
                    } catch (error) {
                        console.error('Sync error for item:', item.id, error);
                        failed.push(item.id);
                    }
                }
                
                // Remove successful items from queue
                const remainingQueue = queue.filter(item => !successful.includes(item.id));
                localStorage.setItem(RLC_CONFIG.STORAGE_KEYS.OFFLINE_QUEUE, JSON.stringify(remainingQueue));
                
                if (successful.length > 0) {
                    this.showSuccess(`Synced ${successful.length} occasions successfully`);
                }
                
                if (failed.length > 0) {
                    this.showWarning(`Failed to sync ${failed.length} occasions. Will retry later.`);
                }
                
                // Update last sync time
                localStorage.setItem(RLC_CONFIG.STORAGE_KEYS.LAST_SYNC, new Date().toISOString());
            }
            
            getOfflineQueue() {
                const queueJson = localStorage.getItem(RLC_CONFIG.STORAGE_KEYS.OFFLINE_QUEUE);
                return queueJson ? JSON.parse(queueJson) : [];
            }
            
            // ==========================================
            // AUTO-SAVE
            // ==========================================
            
            startAutoSave() {
                this.autoSaveTimer = setInterval(() => {
                    if (this.isDirty) {
                        this.autoSave();
                    }
                }, RLC_CONFIG.AUTO_SAVE_INTERVAL);
            }
            
            autoSave() {
                const data = this.collectFormData();
                localStorage.setItem(RLC_CONFIG.STORAGE_KEYS.CURRENT_OCCASION, JSON.stringify(data));
                this.isDirty = false;
                console.log('Auto-saved at', new Date().toLocaleTimeString());
            }
            
            markDirty() {
                this.isDirty = true;
            }
            
            loadSavedData() {
                const saved = localStorage.getItem(RLC_CONFIG.STORAGE_KEYS.CURRENT_OCCASION);
                if (saved) {
                    const data = JSON.parse(saved);
                    // Only load if data is from today
                    const savedDate = new Date(data.date);
                    const today = new Date();
                    if (savedDate.toDateString() === today.toDateString()) {
                        this.populateFormData(data);
                        console.log('Loaded auto-saved data');
                    }
                }
            }
            
            // ==========================================
            // CALCULATIONS
            // ==========================================
            
            calculateProgressivePrize() {
                const jackpot = parseFloat(document.getElementById('prog-jackpot')?.value) || 0;
                const ballsNeeded = parseInt(document.getElementById('prog-balls-needed')?.value) || 48;
                const consolation = parseFloat(document.getElementById('prog-consolation')?.value) || 200;
                const actualBalls = parseInt(document.getElementById('prog-actual-balls')?.value) || 0;
                
                let prize = 0;
                if (actualBalls > 0) {
                    if (actualBalls <= ballsNeeded) {
                        prize = jackpot;
                    } else {
                        prize = consolation;
                    }
                }
                
                document.getElementById('prog-prize').value = prize;
                
                // Update progressive game in session games if it exists
                const progGameRow = document.querySelector('.progressive-row');
                if (progGameRow) {
                    const prizeCell = progGameRow.querySelector('#game-prog-prize');
                    const prizePerInput = progGameRow.querySelector('#prog-prize-per');
                    const totalCell = progGameRow.querySelector('#prog-game-total');
                    
                    if (prizeCell) prizeCell.textContent = prize;
                    if (prizePerInput) prizePerInput.value = prize;
                    if (totalCell) totalCell.textContent = `$${prize.toFixed(2)}`;
                }
                
                this.recalculateAllTotals();
            }
            
            recalculateAllTotals() {
                // Trigger all calculation functions from the original HTML
                if (typeof calculatePaperBingo === 'function') calculatePaperBingo();
                if (typeof calculatePOSDoorSales === 'function') calculatePOSDoorSales();
                if (typeof calculateElectronicBingo === 'function') calculateElectronicBingo();
                if (typeof calculateGameTotals === 'function') calculateGameTotals();
                if (typeof calculatePullTabTotals === 'function') calculatePullTabTotals();
                if (typeof calculateMoneyTotals === 'function') calculateMoneyTotals();
                if (typeof calculateOccasionTotals === 'function') calculateOccasionTotals();
            }
            
            // ==========================================
            // UI HELPERS
            // ==========================================
            
            showLoading(message) {
                const loading = document.getElementById('loading-indicator');
                if (loading) {
                    loading.textContent = message;
                    loading.style.display = 'block';
                }
            }
            
            hideLoading() {
                const loading = document.getElementById('loading-indicator');
                if (loading) {
                    loading.style.display = 'none';
                }
            }
            
            showSuccess(message) {
                this.showNotification(message, 'success');
            }
            
            showError(message) {
                this.showNotification(message, 'error');
            }
            
            showWarning(message) {
                this.showNotification(message, 'warning');
            }
            
            showNotification(message, type) {
                // Create notification element
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                notification.textContent = message;
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 15px 20px;
                    border-radius: 4px;
                    z-index: 9999;
                    animation: slideIn 0.3s;
                    max-width: 300px;
                `;
                
                // Set colors based on type
                const colors = {
                    success: '#27ae60',
                    error: '#e74c3c',
                    warning: '#f39c12'
                };
                notification.style.backgroundColor = colors[type] || '#3498db';
                notification.style.color = 'white';
                
                document.body.appendChild(notification);
                
                // Remove after 5 seconds
                setTimeout(() => {
                    notification.remove();
                }, 5000);
            }
            
            checkOnlineStatus() {
                const statusIndicator = document.getElementById('online-status');
                if (statusIndicator) {
                    if (this.isOnline) {
                        statusIndicator.textContent = ' Online';
                        statusIndicator.style.color = 'green';
                    } else {
                        statusIndicator.textContent = ' Offline';
                        statusIndicator.style.color = 'red';
                    }
                }
            }
            
            handleOnline() {
                this.isOnline = true;
                this.checkOnlineStatus();
                this.showSuccess('Connection restored! Syncing data...');
                this.syncOfflineData();
            }
            
            handleOffline() {
                this.isOnline = false;
                this.checkOnlineStatus();
                this.showWarning('Connection lost. Working offline.');
            }
            
            getDeviceId() {
                let deviceId = localStorage.getItem('rlc_device_id');
                if (!deviceId) {
                    deviceId = 'DEVICE_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                    localStorage.setItem('rlc_device_id', deviceId);
                }
                return deviceId;
            }
            
            clearLocalStorage() {
                localStorage.removeItem(RLC_CONFIG.STORAGE_KEYS.CURRENT_OCCASION);
                this.isDirty = false;
            }
            
            validateFormData(data) {
                // Check required fields
                if (!data.date) return false;
                if (!data.sessionType) return false;
                if (!data.lionInCharge) return false;
                if (data.totalPeople === 0) return false;
                
                return true;
            }
            
            showLoadDialog() {
                // Create a simple dialog to select an occasion to load
                const dialog = document.createElement('div');
                dialog.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: white;
                    padding: 20px;
                    border-radius: 8px;
                    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                    z-index: 10000;
                    min-width: 300px;
                `;
                
                dialog.innerHTML = `
                    <h3>Load Occasion</h3>
                    <input type="date" id="load-date" style="width: 100%; padding: 8px; margin: 10px 0;">
                    <div style="margin-top: 15px;">
                        <button onclick="rlcIntegration.searchOccasions()" style="padding: 8px 15px; background: #3498db; color: white; border: none; border-radius: 4px;">Search</button>
                        <button onclick="this.parentElement.parentElement.remove()" style="padding: 8px 15px; margin-left: 10px;">Cancel</button>
                    </div>
                    <div id="occasion-list" style="margin-top: 15px;"></div>
                `;
                
                document.body.appendChild(dialog);
            }
            
            async searchOccasions() {
                const date = document.getElementById('load-date')?.value;
                if (!date) {
                    alert('Please select a date');
                    return;
                }
                
                try {
                    const response = await fetch(RLC_CONFIG.API_URL + `?path=occasions&date=${date}`);
                    const result = await response.json();
                    
                    if (result.success && result.occasions.length > 0) {
                        const listDiv = document.getElementById('occasion-list');
                        listDiv.innerHTML = '<h4>Select an occasion:</h4>';
                        
                        result.occasions.forEach(occ => {
                            const item = document.createElement('div');
                            item.style.cssText = 'padding: 8px; margin: 5px 0; background: #f0f0f0; cursor: pointer; border-radius: 4px;';
                            item.innerHTML = `
                                <strong>${occ['Session Type']}</strong> - ${occ['Lion In Charge']}<br>
                                <small>Players: ${occ['Total People']} | ID: ${occ['Occasion ID']}</small>
                            `;
                            item.onclick = () => {
                                this.loadOccasion(occ['Occasion ID']);
                                item.parentElement.parentElement.remove();
                            };
                            listDiv.appendChild(item);
                        });
                    } else {
                        alert('No occasions found for this date');
                    }
                } catch (error) {
                    console.error('Search error:', error);
                    alert('Error searching occasions');
                }
            }
        }
        
        // Initialize when DOM is ready
        let rlcIntegration;
        document.addEventListener('DOMContentLoaded', function() {
            rlcIntegration = new RLCBingoIntegration();
            
            // Add save and load buttons if they don't exist
            const buttonGroup = document.querySelector('.button-group');
            if (buttonGroup && !document.getElementById('save-occasion')) {
                const saveButton = document.createElement('button');
                saveButton.id = 'save-occasion';
                saveButton.className = 'success';
                saveButton.textContent = ' Save to Cloud';
                saveButton.style.marginRight = '10px';
                buttonGroup.appendChild(saveButton);
                
                const loadButton = document.createElement('button');
                loadButton.id = 'load-occasion';
                loadButton.className = 'secondary';
                loadButton.textContent = ' Load Occasion';
                buttonGroup.appendChild(loadButton);
            }
            
            // Add online status indicator
            if (!document.getElementById('online-status')) {
                const statusDiv = document.createElement('div');
                statusDiv.id = 'online-status';
                statusDiv.style.cssText = 'position: fixed; top: 10px; right: 10px; padding: 5px 10px; background: white; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); z-index: 9999;';
                statusDiv.textContent = ' Online';
                document.body.appendChild(statusDiv);
            }
            
            // Add loading indicator
            if (!document.getElementById('loading-indicator')) {
                const loadingDiv = document.createElement('div');
                loadingDiv.id = 'loading-indicator';
                loadingDiv.style.cssText = 'display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); padding: 20px; background: white; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 10000;';
                loadingDiv.textContent = 'Loading...';
                document.body.appendChild(loadingDiv);
            }
        });
        
        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            .notification {
                transition: all 0.3s ease;
            }
            
            .notification:hover {
                transform: scale(1.02);
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>